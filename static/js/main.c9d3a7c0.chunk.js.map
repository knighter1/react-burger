{"version":3,"sources":["components/App/App.module.css","components/IngredientsList/IngredientsList.module.css","components/Modal/Modal.module.css","components/OrderInfoDetails/OrderInfoDetails.module.css","components/ModalOverlay/ModalOverlay.module.css","pages/Constructor/Constructor.module.css","pages/OrdersFeed/OrdersFeed.module.css","pages/ProfileOrders/ProfileOrders.module.css","components/OrderListItem/OrderListItem.module.css","components/IngredientMenuList/IngredientMenuList.tsx","components/HeaderItem/HeaderItem.tsx","components/AppHeader/AppHeader.tsx","redux/actions/ingredient.ts","hooks/index.ts","components/IngredientMenuItem/IngredientMenuItem.tsx","components/BurgerIngredients/BurgerIngredients.tsx","redux/actions/constructor.ts","components/IngredientsListItem/IngredientsListItem.tsx","components/ModalOverlay/ModalOverlay.tsx","components/Modal/Modal.tsx","images/modal_close_btn.png","components/IngredientDetails/IngredientDetails.tsx","components/IngredientsList/IngredientsList.tsx","images/order_done.png","components/OrderDetails/OrderDetails.tsx","utils/cookie.js","services/fetchWithRefresh.ts","redux/actions/order.ts","components/BurgerConstructor/BurgerConstructor.tsx","pages/Constructor/Constructor.tsx","components/SignInForm/SignInForm.tsx","redux/actions/auth.ts","pages/SignIn/SignIn.tsx","components/RegisterForm/RegisterForm.tsx","redux/actions/register.ts","pages/Register/Register.tsx","components/ForgotPasswordForm/ForgotPasswordForm.tsx","redux/actions/initResetPassword.ts","pages/ForgotPassword/ForgotPassword.tsx","components/ResetPasswordForm/ResetPasswordForm.tsx","redux/actions/resetPassword.ts","pages/ResetPassword/ResetPassword.tsx","redux/reducers/constructor.ts","redux/reducers/utils.ts","redux/actions/orderDetails.ts","components/OrderListItem/OrderListItem.tsx","components/OrdersList/OrdersList.tsx","components/OrdersStat/OrdersStat.tsx","redux/actions/feedWsActions.ts","pages/OrdersFeed/OrdersFeed.tsx","components/ProfileMenu/ProfileMenu.tsx","redux/actions/profile.ts","pages/Profile/Profile.tsx","components/ProtectedRoute/ProtectedRoute.tsx","pages/Ingredient/Ingredient.tsx","pages/NotFound404/NotFound404.tsx","components/OrderInfoDetails/OrderInfoDetails.tsx","redux/actions/ingredientsLib.ts","pages/OrderDetail/OrderDetail.tsx","redux/actions/userWsActions.ts","pages/ProfileOrders/ProfileOrders.tsx","components/App/App.tsx","reportWebVitals.ts","redux/reducers/ingredientsLib.ts","redux/reducers/order.ts","redux/reducers/initResetPassword.ts","redux/reducers/resetPassword.ts","redux/reducers/access.ts","redux/reducers/orderDetails.ts","redux/reducers/feedWsReducer.ts","redux/middlewares/wsMiddleware.ts","redux/reducers/userWsReducer.ts","redux/reducers/index.ts","redux/reducers/ingredient.ts","index.tsx","components/OrdersStat/OrdersStat.module.css","components/RegisterForm/RegisterForm.module.css","pages/Profile/Profile.module.css","components/AppHeader/AppHeader.module.css","components/IngredientMenuItem/IngredientMenuItem.module.css","pages/SignIn/SignIn.module.css","components/SignInForm/SignInForm.module.css","components/ResetPasswordForm/ResetPasswordForm.module.css","components/ProfileMenu/ProfileMenu.module.css","components/BurgerConstructor/BurgerConstructor.module.css","components/IngredientDetails/IngredientDetails.module.css","components/OrderDetails/OrderDetails.module.css","pages/Register/Register.module.css","pages/ForgotPassword/ForgotPassword.module.css","components/ForgotPasswordForm/ForgotPasswordForm.module.css","pages/ResetPassword/ResetPassword.module.css","components/OrdersList/OrdersList.module.css","components/IngredientMenuList/IngredientMenuList.module.css","components/IngredientsListItem/IngredientsListItem.module.css","pages/NotFound404/NotFound404.module.css","components/HeaderItem/HeaderItem.module.css","components/BurgerIngredients/BurgerIngredients.module.css"],"names":["module","exports","IngredientTypes","HeaderItem","caption","Icon","type","textColor","className","styles","item","icon","AppHeader","location","useLocation","isConstructor","pathname","isProfile","isFeed","constructorCont","BurgerIcon","profileCont","ProfileIcon","feedCont","ListIcon","row","sideRow","left","to","right","SET_INGREDIENT","setIngredient","ingredientData","useSelector","selectorHook","useDispatch","dispatchHook","IngredientMenuItem","data","dispatch","useDrag","collect","monitor","isDrag","isDragging","dragRef","menuItem","count","store","items","constructor","countResult","filter","_id","length","bun","state","background","onClick","ref","size","src","image","alt","name","priceBlock","price","INGREDIENTS_NAMES","IngredientMenuList","changeTypeHandler","ingredients","ingredientsLib","bunsList","element","mainList","main","saucesList","sauce","viewSets","threshold","useInView","bunsRef","inViewBuns","mainRef","inViewMain","saucesRef","inViewSauces","useEffect","renderCategory","elementRef","categoryBlock","id","listCategory","map","categories","list","BurgerIngredients","useState","currentType","setCurrentType","types","section","menu","value","active","document","querySelector","scrollIntoView","behavior","setCurrentTab","ADD_ITEM","REMOVE_ITEM","REORDER_ITEM","RESET_ORDER","IngredientsListItem","index","onClickHandler","useRef","prevIndex","useDrop","accept","drop","newIndex","dropRef","elementProps","text","thumbnail","image_mobile","isLocked","handleClose","constructorRemoveItem","buttonPaddingStyle","elementPaddingStyle","ModalOverlay","closeHandle","children","escapeKeyDownHandler","event","key","addEventListener","removeEventListener","overlay","modalRoot","getElementById","Modal","ReactDOM","createPortal","modalContainer","stopPropagation","IngredientDetails","ingredient","characteristic","charName","charValue","charItem","pageContainer","title","image_large","characteristics","calories","proteins","fat","carbohydrates","IngredientsList","modalState","setModalState","toString","OrderDetails","content","orderId","order","orderDoneImg","forming","orderDetail","getCookie","matches","cookie","match","RegExp","replace","decodeURIComponent","undefined","setCookie","props","path","exp","expires","d","Date","setTime","getTime","toUTCString","updatedCookie","encodeURIComponent","propName","propValue","checkResponse","response","ok","json","then","err","Promise","reject","refreshToken","options","method","headers","body","JSON","stringify","token","fetch","fetchWithRefresh","url","a","res","message","refreshData","accessToken","Authorization","PLACE_ORDER_REQUEST","PLACE_ORDER_ERROR","PLACE_ORDER_SUCCESS","placeOrder","currentItems","setOrderModalState","push","getFullIngredients","success","status","responseObj","number","placeOrderSuccess","catch","error","console","BurgerConstructor","first","last","buns","setBuns","Object","assign","orderModalState","isAuth","access","history","useHistory","dropTarget","ingredientClickHandler","onIngredientClick","scrollableList","commitOrderWrapper","cost","buttonWrapper","ConstructorPage","page","DndProvider","backend","HTML5Backend","SignInForm","handler","email","setEmail","password","setPassword","onSubmit","preventDefault","onSubmitHandler","formRow","onChange","target","SIGNIN_REQUEST","SIGNIN_SUCCESS","SIGNIN_ERROR","LOGOUT_REQUEST","LOGOUT_SUCCESS","LOGOUT_ERROR","loginRequest","mode","cache","credentials","redirect","referrerPolicy","signIn","user","logout","signOut","SignInPage","from","links","linksRow","blueLink","RegisterForm","setName","placeholder","REGISTER_REQUEST","REGISTER_SUCCESS","REGISTER_ERROR","register","RegisterPage","center","registerHandler","ForgotPasswordForm","INIT_RESET_PASSWORD_REQUEST","INIT_RESET_PASSWORD_SUCCESS","INIT_RESET_PASSWORD_ERROR","initResetPassword","ForgotPasswordPage","initResetPasswordHandler","ResetPasswordForm","setToken","RESET_PASSWORD_REQUEST","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_ERROR","resetPassword","ResetPasswordPage","resetPasswordHandler","constructorInitState","orderCostReducer","costValue","reduce","acc","formatOrderDate","date","moment","calendar","sameDay","lastDay","lastWeek","sameElse","SET_ORDER_DETAIL","GET_ORDER_BY_ID_REQUEST","GET_ORDER_BY_ID_SUCCESS","GET_ORDER_BY_ID_ERROR","getOrderById","lib","END_POINT","orderData","ingredientsIds","orders","itemsById","get","getOrderByIdSuccess","OrderListItem","_ingredients","setCost","setIngredients","orderIngredients","slice","statusName","statusClassName","orderSelect","statusDone","statusPending","statusCreated","statusCancled","cont","top","substr","bottom","ingredientsCount","overCount","Math","max","ingredintsRow","style","backgroundImage","zIndex","ingredientImage","ingredientsCont","priceCont","OrdersList","feed","sectionClassName","smallSection","largeSection","itemsCont","updatedAt","createdAt","OrdersStat","completedOrders","setCompletedOrders","prcessingOrders","setPrcessingOrders","feedWs","completed","processing","statOper","statOperCol","statOrderList","completedOrder","statCont","digitsLarge","total","totalToday","FEED_WS_CONNECTION_START","FEED_WS_CONNECTION_SUCCESS","FEED_WS_CONNECTION_ERROR","FEED_WS_CONNECTION_CLOSED","FEED_WS_GET_MESSAGE","OrdersFeedPage","ProfileMenu","isOrders","ordersCont","column","GET_USER_REQUEST","GET_USER_SUCCESS","GET_USER_ERROR","PATCH_USER_REQUEST","PATCH_USER_SUCCESS","PATCH_USER_ERROR","USER_END_POINT","updateUserInfo","onPatchSuccess","info","fetchGetUser","getUser","ProfilePage","isModified","setIsModified","initUser","onPathSuccess","field","cancel","ProtectedRoute","exact","render","IngredientPage","useParams","find","NotFound404Page","linkCont","OrderInfoDetails","inProgressStatus","orderDetails","itemCont","leftItemCont","nameCont","rightItemCont","itemPrice","getItemCont","GET_INGREDIENTS_LIB_REQUEST","GET_INGREDIENTS_LIB_SUCCESS","GET_INGREDIENTS_LIB_ERROR","getIngredientsLib","OrderDetailPage","USER_WS_CONNECTION_START","USER_WS_CONNECTION_SUCCESS","USER_WS_CONNECTION_ERROR","USER_WS_CONNECTION_CLOSED","USER_WS_GET_MESSAGE","userWsConnectionStart","payload","ProfileOrdersPage","userWs","ModalSwitch","action","goBack","App","appCont","basename","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initState","Map","isError","isRequest","wsActionsFeed","wsInit","onOpen","onClose","feedWsConnectionClosed","onError","feedWsConnectionError","onMessage","initialState","wsConnected","socketMiddleware","wsUrl","wsActions","socket","next","WebSocket","onopen","onerror","onmessage","onclose","reason","wsActionsUser","userWsConnectionClosed","userWsConnectionError","userWsGetMessage","rootReducer","combineReducers","forEach","set","splice","parse","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","wsFeed","wsUser","enhancer","applyMiddleware","thunk","createStore","StrictMode"],"mappings":"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","file":"static/js/main.c9d3a7c0.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"appCont\":\"App_appCont__3jvQA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"IngredientsList_list__1199E\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modalContainer\":\"Modal_modalContainer__2vJl1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"OrderInfoDetails_page__101S_\",\"center\":\"OrderInfoDetails_center__AZVVr\",\"completed\":\"OrderInfoDetails_completed__2vIzb\",\"bottom\":\"OrderInfoDetails_bottom__21BnO\",\"cost\":\"OrderInfoDetails_cost__dBfo_\",\"priceCont\":\"OrderInfoDetails_priceCont__3BGxq\",\"itemCont\":\"OrderInfoDetails_itemCont__dMCvF\",\"leftItemCont\":\"OrderInfoDetails_leftItemCont__26SJt\",\"rightItemCont\":\"OrderInfoDetails_rightItemCont__1T97u\",\"ingredientImage\":\"OrderInfoDetails_ingredientImage__Lkn8h\",\"nameCont\":\"OrderInfoDetails_nameCont__2rSAP\",\"name\":\"OrderInfoDetails_name__blLV3\",\"itemPrice\":\"OrderInfoDetails_itemPrice__3coT8\",\"list\":\"OrderInfoDetails_list__2ifX7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"ModalOverlay_overlay__1eIOp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"Constructor_page__3f5U5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"OrdersFeed_page__3TZSE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"ProfileOrders_page__2yi0V\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cont\":\"OrderListItem_cont__2SliZ\",\"top\":\"OrderListItem_top__3Benp\",\"bottom\":\"OrderListItem_bottom__2qjZ1\",\"cost\":\"OrderListItem_cost__275NM\",\"ingredintsRow\":\"OrderListItem_ingredintsRow__3311r\",\"ingredientImage\":\"OrderListItem_ingredientImage__1KroX\",\"overCount\":\"OrderListItem_overCount__3D4hK\",\"priceCont\":\"OrderListItem_priceCont__2ob3C\",\"statusDone\":\"OrderListItem_statusDone__OKjiD\",\"statusCreated\":\"OrderListItem_statusCreated__1IGTo\",\"statusCanceled\":\"OrderListItem_statusCanceled__BY_aM\"};","import { IngredientMenuItem } from '../IngredientMenuItem/IngredientMenuItem';\r\nimport styles from './IngredientMenuList.module.css';\r\nimport { FC, LegacyRef, useEffect } from 'react';\r\nimport { useInView } from \"react-intersection-observer\";\r\nimport { IngredientData } from '../../types/IIngredientData';\r\nimport { useSelector } from '../../hooks';\r\n\r\ninterface IIngredientMenuListProps\r\n{\r\n    changeTypeHandler: (ingredintType: string) => void;\r\n}\r\n\r\nexport enum IngredientTypes\r\n{\r\n    bun,\r\n    sauce,\r\n    main\r\n}\r\n\r\nexport const INGREDIENTS_NAMES: string[] = [\"Булки\", \"Соусы\", \"Начинки\"];\r\n\r\nexport const IngredientMenuList: FC<IIngredientMenuListProps> = ({changeTypeHandler}) =>\r\n{\r\n    const ingredients = useSelector(store => store.ingredientsLib.items);\r\n\r\n    const bunsList: IngredientData[] = ingredients ? ingredients.filter(element => element.type === IngredientTypes[IngredientTypes.bun]) : [];\r\n    const mainList: IngredientData[] = ingredients ? ingredients.filter(element => element.type === IngredientTypes[IngredientTypes.main]) : [];\r\n    const saucesList: IngredientData[] = ingredients ? ingredients.filter(element => element.type === IngredientTypes[IngredientTypes.sauce]) : [];\r\n\r\n    const viewSets = {\r\n        threshold: 0,\r\n    };\r\n\r\n    const [bunsRef, inViewBuns] = useInView(viewSets);\r\n    const [mainRef, inViewMain] = useInView(viewSets);\r\n    const [saucesRef, inViewSauces] = useInView(viewSets);\r\n\r\n    useEffect(() => {\r\n        if (inViewBuns) {\r\n            changeTypeHandler(IngredientTypes[IngredientTypes.bun]);\r\n        }\r\n        else if (inViewSauces) {\r\n            changeTypeHandler(IngredientTypes[IngredientTypes.sauce]);\r\n        }\r\n        else if (inViewMain) {\r\n            changeTypeHandler(IngredientTypes[IngredientTypes.main]);\r\n        }\r\n    }, [inViewBuns, inViewMain, inViewSauces, changeTypeHandler]);\r\n\r\n    const renderCategory = (type: IngredientTypes, data: IngredientData[], elementRef: LegacyRef<HTMLDivElement>) =>\r\n    {\r\n        if (!data.length)\r\n            return null;\r\n\r\n        return (\r\n            <div key={IngredientTypes[type]} className={styles.categoryBlock} ref={elementRef}>\r\n                <span id={`menu_${IngredientTypes[type]}`} className={`${styles.listCategory} text text_type_main-medium pt-2`}>{INGREDIENTS_NAMES[type]}</span>\r\n                {\r\n                    data.map(element => <IngredientMenuItem key={element._id} data={element} />)\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const categories = [\r\n        renderCategory(IngredientTypes.bun, bunsList, bunsRef),\r\n        renderCategory(IngredientTypes.sauce, saucesList, saucesRef),\r\n        renderCategory(IngredientTypes.main, mainList, mainRef)\r\n    ];\r\n\r\n    return (\r\n        <div className={styles.list}>\r\n            { categories }\r\n        </div>\r\n    );\r\n}","\r\nimport { FC } from 'react';\r\nimport styles from './HeaderItem.module.css';\r\n\r\ninterface IHeaderLinkProps {\r\n    caption: string;\r\n    Icon: Function;\r\n    type: \"primary\" | \"secondary\";\r\n}\r\n\r\nconst HeaderItem: FC<IHeaderLinkProps> = ({ caption, Icon, type }) =>\r\n{    \r\n    const textColor = type === \"secondary\" ? \"text_color_inactive\" : \"\";\r\n    \r\n    return (\r\n        <div className={`pl-5 pr-5 pt-4 pb-4 mt-4 mb-4 ml-1 mr-1 ${styles.item}`}>\r\n            <Icon className={styles.icon} type={type} />\r\n            <span className={`pl-2 text_type_main-default ${textColor}`}>\r\n                {caption}\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default HeaderItem;","import { Logo, BurgerIcon, ListIcon, ProfileIcon } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FC } from 'react';\r\nimport { Link, useLocation } from 'react-router-dom';\r\nimport HeaderItem from '../HeaderItem/HeaderItem';\r\nimport styles from './AppHeader.module.css';\r\n\r\nconst AppHeader: FC = () => {\r\n\r\n    const location = useLocation();\r\n    \r\n    const isConstructor: boolean = location.pathname === '/';\r\n    const isProfile: boolean = location.pathname === '/profile';\r\n    const isFeed: boolean = location.pathname === '/feed';\r\n\r\n    const constructorCont = (\r\n        <HeaderItem\r\n            Icon={BurgerIcon}\r\n            caption='Конструктор'\r\n            type={ isConstructor ? \"primary\" : \"secondary\"}\r\n        />\r\n    );\r\n\r\n    const profileCont = (\r\n        <HeaderItem\r\n            Icon={ProfileIcon}\r\n            caption='Личный кабинет'\r\n            type={isProfile ? \"primary\" : \"secondary\"}\r\n        />\r\n    );\r\n\r\n    const feedCont = (\r\n        <HeaderItem\r\n            Icon={ListIcon}\r\n            caption='Лента заказов'\r\n            type={isFeed ? \"primary\" : \"secondary\"}\r\n        />\r\n    )\r\n\r\n    return (\r\n        <header className={styles.row}>\r\n            <nav className={`${styles.sideRow} ${styles.left}`}>\r\n                {!isConstructor ? <Link to='/'>{constructorCont}</Link> : constructorCont}\r\n                {!isFeed ? <Link to='/feed'>{feedCont}</Link> : feedCont}\r\n            </nav>\r\n            <Link to='/'>\r\n                <Logo />\r\n            </Link>\r\n            <nav className={`${styles.sideRow} ${styles.right}`}>\r\n                {!isProfile ? <Link to='/profile'>{profileCont}</Link> : profileCont}\r\n            </nav>\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default AppHeader;","import { IngredientData } from \"../../types/IIngredientData\";\r\n\r\nexport const SET_INGREDIENT = 'SET_INGREDIENT';\r\n\r\nexport interface ISetIngredientAction {\r\n    readonly type: typeof SET_INGREDIENT;\r\n    readonly ingredientData: IngredientData | null;\r\n}\r\n\r\nexport const setIngredient = (item: IngredientData | null): ISetIngredientAction => ({ type: SET_INGREDIENT, ingredientData: item });","import { TypedUseSelectorHook, useSelector as selectorHook, useDispatch as dispatchHook } from \"react-redux\";\r\nimport { AppDispatch, AppThunk, TStore } from \"../redux/reducers\";\r\n\r\nexport const useSelector: TypedUseSelectorHook<TStore> = selectorHook;\r\n\r\nexport const useDispatch = () => dispatchHook<AppDispatch | AppThunk>();","import styles from './IngredientMenuItem.module.css';\r\nimport { CurrencyIcon, Counter } from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport { setIngredient } from '../../redux/actions/ingredient';\r\nimport { useDrag } from 'react-dnd';\r\nimport { Link, useLocation } from 'react-router-dom';\r\nimport { IngredientData } from '../../types/IIngredientData';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\ninterface IIngredientMenuItemProps\r\n{\r\n    data: IngredientData\r\n}\r\n\r\nexport const IngredientMenuItem: FC<IIngredientMenuItemProps> = ({ data }) =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const onItemClick = () =>\r\n    {\r\n        dispatch(setIngredient(data));\r\n    }\r\n\r\n    const [{isDrag}, dragRef] = useDrag({\r\n        type: \"ingredients\",\r\n        item: data,\r\n        collect: monitor => ({\r\n            isDrag: monitor.isDragging()\r\n        })\r\n    });\r\n\r\n    const className = `${styles.menuItem} mt-6 mb-8 ml-4 mr-2 ${isDrag ? styles.isDrag : ''}`;\r\n\r\n    const count = useSelector(store => {\r\n        \r\n        const items: IngredientData[] = store.constructor.items\r\n        let countResult: number = items ? items.filter(item => item._id === data._id).length : 0;\r\n\r\n        if (data === store.constructor.bun)\r\n            countResult = 2;\r\n\r\n        return countResult;\r\n    });\r\n\r\n    const location = useLocation();\r\n\r\n    return (\r\n        <Link to={{\r\n            pathname: `/ingredients/${data._id}`,\r\n            state: {background: location}\r\n        }}>\r\n            <div className={className}\r\n                onClick={onItemClick}\r\n                ref={dragRef} >\r\n                {count > 0 && <Counter count={count} size=\"default\" />}\r\n\r\n                <img className=\"ml-4 mr-4\" src={data.image} alt={data.name} />\r\n                <div className={`mt-1 mb-1\" ${styles.priceBlock}`}>\r\n                    <span className={`text text_type_digits-default pr-2 ${styles.price}`}>{data.price}</span>\r\n                    <CurrencyIcon type=\"primary\" />\r\n                </div>\r\n                <span className={`text_type_main-default ${styles.name}`}>{data.name}</span>\r\n            </div>\r\n        </Link>\r\n    )\r\n}","import { FC, useState } from 'react';\r\nimport { Tab } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { IngredientMenuList, INGREDIENTS_NAMES, IngredientTypes } from '../IngredientMenuList/IngredientMenuList';\r\nimport styles from './BurgerIngredients.module.css';\r\n\r\nconst BurgerIngredients: FC = () =>\r\n{\r\n    const [currentType, setCurrentType] = useState(IngredientTypes[IngredientTypes.bun]);\r\n    const types: IngredientTypes[] = [IngredientTypes.bun, IngredientTypes.sauce, IngredientTypes.main];\r\n\r\n    const setCurrentTab = (type: string): void =>\r\n    {\r\n        setCurrentType(type);\r\n        document.querySelector('#menu_' + type)?.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n\r\n    return (\r\n        <section className={styles.section}>\r\n            <div className=\"text text_type_main-large pt-10 pb-5\">Соберите бургер</div>\r\n            <div className={`${styles.menu} pb-10`}>\r\n                {\r\n                    types.map(type => {\r\n                        const handler = (type: string) => setCurrentTab(type);\r\n                        const state: boolean = currentType === IngredientTypes[type];\r\n                        return (\r\n                            <Tab key={type} value={IngredientTypes[type]} active={state} onClick={handler}>\r\n                                {INGREDIENTS_NAMES[type]}\r\n                            </Tab>\r\n                        )\r\n                    })\r\n                }\r\n            </div>\r\n            <IngredientMenuList changeTypeHandler={(type: string) => setCurrentType(type)} />\r\n        </section>   \r\n    )\r\n}\r\n\r\nexport default BurgerIngredients;","import { IngredientData } from \"../../types/IIngredientData\";\r\n\r\nexport const ADD_ITEM = 'ADD_ITEM';\r\nexport const REMOVE_ITEM = 'REMOVE_ITEM';\r\nexport const REORDER_ITEM = 'REORDER_ITEM';\r\nexport const RESET_ORDER = 'RESET_ORDER';\r\n\r\nexport interface IAddItemAction {\r\n    readonly type: typeof ADD_ITEM;\r\n    readonly item: IngredientData;\r\n}\r\n\r\nexport interface IRemoveItemAction {\r\n    readonly type: typeof REMOVE_ITEM;\r\n    readonly index: number;\r\n}\r\n\r\nexport interface IReorderItemAction {\r\n    readonly type: typeof REORDER_ITEM;\r\n    readonly prevIndex: number;\r\n    readonly newIndex: number;\r\n}\r\n\r\nexport interface IResetOrderAction {\r\n    readonly type: typeof RESET_ORDER;\r\n}\r\n\r\nexport type TConstructorActions = \r\n    | IAddItemAction\r\n    | IRemoveItemAction\r\n    | IReorderItemAction\r\n    | IResetOrderAction;\r\n\r\nexport const constructorAddItem = (item: IngredientData): TConstructorActions => ({ type: ADD_ITEM, item: item });\r\n\r\nexport const constructorRemoveItem = (index: number): TConstructorActions => ({ type: REMOVE_ITEM, index: index });\r\n\r\nexport const constructorReorderItem = (prevIndex: number, newIndex: number): TConstructorActions => ({ type: REORDER_ITEM, prevIndex: prevIndex, newIndex: newIndex });\r\n\r\nexport const resetOrder = (): IResetOrderAction => ({ type: RESET_ORDER });","import { FC, useRef } from 'react';\r\nimport styles from './IngredientsListItem.module.css';\r\nimport { ConstructorElement, DragIcon } from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport { constructorRemoveItem, constructorReorderItem } from '../../redux/actions/constructor';\r\nimport { useDrag, useDrop } from 'react-dnd';\r\nimport { IngredientData } from '../../types/IIngredientData';\r\nimport { useDispatch } from '../../hooks';\r\n\r\ninterface IConstructorElement {\r\n    type?: 'top' | 'bottom';\r\n    isLocked?: boolean;\r\n    text: string;\r\n    thumbnail: string;\r\n    price: number;\r\n    handleClose?: () => void;\r\n};\r\n\r\ninterface IIngredientsListItemProps\r\n{\r\n    data: IngredientData;\r\n    index: number;\r\n    type?: \"top\" | \"bottom\";\r\n    onClickHandler: (data: IngredientData) => void;\r\n}\r\n\r\ninterface DragableItem\r\n{\r\n    data: IngredientData;\r\n    prevIndex: number;\r\n}\r\n\r\nconst IngredientsListItem: FC<IIngredientsListItemProps> = ({ data, index, type, onClickHandler }) =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const elementRef = useRef(null);\r\n\r\n    const getElementProps = (item: IngredientData) =>\r\n    {\r\n        const elementProps: IConstructorElement = {\r\n            text: item.name,\r\n            price: item.price,\r\n            thumbnail: item.image_mobile,\r\n            type: type,\r\n            isLocked: type ? true : false,\r\n            handleClose: () => dispatch(constructorRemoveItem(index))\r\n        };\r\n\r\n        return elementProps;\r\n    }\r\n\r\n    const [{isDrag}, dragRef] = useDrag(\r\n    {\r\n        type: !type ? \"reorder\" : \"\",\r\n        item: { data: data, prevIndex: index },\r\n        collect: monitor => ({\r\n            isDrag: monitor.isDragging()\r\n        })\r\n    });\r\n\r\n    const [, dropRef] = useDrop(\r\n    {\r\n        accept: \"reorder\",\r\n        drop(item: DragableItem) {\r\n            dispatch(constructorReorderItem(item.prevIndex, index))\r\n        },\r\n    });\r\n\r\n    dragRef(dropRef(elementRef));\r\n\r\n    const elementProps = getElementProps(data);\r\n\r\n    const buttonPaddingStyle = elementProps.isLocked ? \"pr-8 pl-6\" : \"pr-2\";\r\n    let elementPaddingStyle = elementProps.isLocked ? \"pr-4\" : \"\";\r\n    elementPaddingStyle += !elementProps.isLocked ? \"mb-2 mt-2\" : \"\";\r\n    \r\n    const className = `${styles.item} ${isDrag ? styles.isDrag : \"\"}`;\r\n\r\n    return (\r\n        <div className={className} ref={elementRef} >\r\n            <div className={buttonPaddingStyle} >\r\n                {!elementProps.isLocked && <DragIcon type=\"primary\" />}\r\n            </div>\r\n            <div className={`${styles.element} ${elementPaddingStyle}`} onClick={() => onClickHandler(data)}>\r\n                <ConstructorElement {...elementProps} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default IngredientsListItem;","import { FC, useEffect } from 'react';\r\nimport styles from './ModalOverlay.module.css'\r\n\r\ninterface IModalOverlayProps\r\n{\r\n    closeHandle: () => void;\r\n    children: JSX.Element;\r\n}\r\n\r\nexport const ModalOverlay: FC<IModalOverlayProps> = ({ closeHandle, children }) =>\r\n{\r\n    useEffect(() => {\r\n        const escapeKeyDownHandler = (event: KeyboardEvent) => {\r\n            if (event.key === 'Escape')\r\n                closeHandle();\r\n        }\r\n\r\n        document.addEventListener('keydown', escapeKeyDownHandler);\r\n        return () => document.removeEventListener(\"keydown\", escapeKeyDownHandler);\r\n    }, [closeHandle]);\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={() => closeHandle()}>\r\n            {children}\r\n        </div>\r\n    )\r\n}","import styles from './Modal.module.css';\r\nimport ReactDOM from 'react-dom';\r\nimport { ModalOverlay } from '../ModalOverlay/ModalOverlay';\r\nimport modalCloseBtnImg from '../../images/modal_close_btn.png';\r\nimport { FC } from 'react';\r\n\r\nconst modalRoot: HTMLElement = document.getElementById(\"modals\") as HTMLElement;\r\n\r\nexport interface IModal {\r\n    closeHandle: () => void,\r\n    children: JSX.Element\r\n}\r\n\r\nexport const Modal: FC<IModal> = ({ closeHandle, children }: IModal) =>\r\n{\r\n    return ReactDOM.createPortal( \r\n       (\r\n            <ModalOverlay closeHandle={() => closeHandle()}>\r\n                <div className={styles.modalContainer} onClick={(event) => event.stopPropagation()}>\r\n                    {children}\r\n                    <img className='modal-close-btn' src={modalCloseBtnImg} onClick={() => closeHandle() } alt=\"Закрыть\" />\r\n                </div>\r\n            </ModalOverlay>\r\n        ),\r\n        modalRoot\r\n    );\r\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADPSURBVHgBlZTbDcMgDEUxUQdgg6ySyTNK2ACF9q8Cl1ukKiU8jH9i2c6RsS+Q969DJQvhvRljrJow59y6LI8dvmaO6cPfABLzEF7B0DGGjZntDOwfwhaMX+I8/eH9k3HUHgw51KAW/9xqJbAhRAIbQagG03rZiSgVksU2ES9nUm6YWp1dYTnahjRBd1jCdCAwrTpGpKt+tVY1urnOJIPQWZ6Z6GgtsZUL6F6n3orFopWIbQgTK7YDo9pMRs9JTbSU3yM5pAUjtInEDKSEwf8AUWh+6yealnMAAAAASUVORK5CYII=\"","import styles from './IngredientDetails.module.css';\r\nimport { FC, useEffect } from 'react';\r\nimport { setIngredient } from '../../redux/actions/ingredient';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\n\r\nexport const IngredientDetails: FC = () => {\r\n\r\n    const ingredientData = useSelector(store => store.ingredient);\r\n    \r\n    const dispatch = useDispatch();\r\n\r\n    const characteristic = (charName: string, charValue: number) => (\r\n        <ul className={`${styles.charItem}`}>\r\n            <li className='text text_type_main-default text_color_inactive'>{charName}</li>\r\n            <li className='text text_type_digits-default text_color_inactive'>{charValue}</li>\r\n        </ul>\r\n    )\r\n\r\n    useEffect(() =>\r\n    {\r\n        return (() => { dispatch(setIngredient(null)) })\r\n    }, [dispatch]);\r\n\r\n    if (!ingredientData)\r\n        return null;\r\n\r\n    return (\r\n        <div className={`${styles.pageContainer} modal-сontent`}>\r\n            <div className={`${styles.title} text text_type_main-large ml-10 mt-10 mr-10 pt-2`}>\r\n                Детали ингредиента\r\n            </div>\r\n            <img src={ingredientData.image_large} alt={ingredientData.name} />\r\n            <div className={`text text_type_main-medium mt-4 mb-8`}>\r\n                {ingredientData.name}\r\n            </div>\r\n            <div className={`${styles.characteristics} mb-15`}>\r\n                {characteristic('Калории,ккал', ingredientData.calories)}\r\n                {characteristic('Белки, г', ingredientData.proteins)}\r\n                {characteristic('Жиры, г', ingredientData.fat)}\r\n                {characteristic('Углеводы, г', ingredientData.carbohydrates)}\r\n            </div>\r\n        </div>\r\n    );\r\n}","import { FC, useState } from 'react';\r\nimport styles from './IngredientsList.module.css';\r\nimport IngredientsListItem from '../IngredientsListItem/IngredientsListItem';\r\nimport { Modal } from '../Modal/Modal';\r\nimport { IngredientDetails } from '../IngredientDetails/IngredientDetails';\r\nimport { IngredientData } from '../../types/IIngredientData';\r\n\r\ninterface IIngredientsListProps\r\n{\r\n    items: IngredientData[];\r\n    onClickHandler: (data: IngredientData) => void;\r\n}\r\n\r\nconst IngredientsList: FC<IIngredientsListProps> = ({ items, onClickHandler }) =>\r\n{\r\n    const [modalState, setModalState] = useState(false);\r\n\r\n    return (\r\n        <div className={`${styles.list} pl-4 pr-2`}>\r\n            {\r\n                items.map((item, index) => {\r\n                    return <IngredientsListItem key={item._id + index.toString()} data={item} index={index} onClickHandler={onClickHandler} />\r\n                })\r\n            }\r\n            {modalState && <Modal closeHandle={() => setModalState(false)}><IngredientDetails /></Modal>}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default IngredientsList;","export default __webpack_public_path__ + \"static/media/order_done.e036971b.png\";","import styles from './OrderDetails.module.css';\r\nimport orderDoneImg from '../../images/order_done.png';\r\nimport { useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\nexport const OrderDetails: FC = () =>\r\n{\r\n    const orderId = useSelector(store => store.order.orderId);\r\n\r\n    let content;\r\n    if (orderId)\r\n        content = (\r\n            <>\r\n                <div className={`${styles.orderId} text text_type_digits-large pt-30`}>\r\n                    <span>{orderId}</span>\r\n                </div>\r\n                <div className=\"text text_type_main-medium mt-8\">идентификатор заказа</div>\r\n                <img className=\"mt-15\" src={orderDoneImg} alt=\"Заказ размещен\" />\r\n                <div className=\"text text_type_main-default mt-15\">Ваш заказ начали готовить</div>\r\n                <div className=\"text text_type_main-default text_color_inactive mt-2 mb-30\">Дождитесь готовности на орбитальной станции</div>\r\n            </>);\r\n    else\r\n        content = (\r\n            <>\r\n                <div className={`text text_type_main-large ${styles.forming}`}>Формирование заказа</div>\r\n                <div className={`text text_type_main-medium ${styles.forming}`}>Ожидайте...</div>\r\n            </>\r\n        )\r\n\r\n    return (\r\n        <div className={`${styles.orderDetail} modal-сontent`}>\r\n            {content}\r\n        </div>\r\n    );\r\n}","export function getCookie(name)\r\n{\r\n    const matches = document.cookie.match(\r\n      new RegExp('(?:^|; )' + name.replace(/([.$?*|{}()[\\]\\\\/+^])/g, '\\\\$1') + '=([^;]*)')\r\n    );\r\n    return matches ? decodeURIComponent(matches[1]) : undefined;\r\n} \r\n  \r\nexport function setCookie(name, value, props = { path: '/' })\r\n{\r\n    props = props || {};\r\n    let exp = props.expires;\r\n    if (typeof exp == 'number' && exp) {\r\n      const d = new Date();\r\n      d.setTime(d.getTime() + exp * 1000);\r\n      exp = props.expires = d;\r\n    }\r\n    if (exp && exp.toUTCString) {\r\n      props.expires = exp.toUTCString();\r\n    }\r\n    value = encodeURIComponent(value);\r\n    let updatedCookie = name + '=' + value;\r\n    for (const propName in props) {\r\n      updatedCookie += '; ' + propName;\r\n      const propValue = props[propName];\r\n      if (propValue !== true) {\r\n        updatedCookie += '=' + propValue;\r\n      }\r\n    }\r\n    document.cookie = updatedCookie;\r\n}","import { getCookie, setCookie } from \"../utils/cookie\";\r\n\r\ninterface IResponse extends Body\r\n{\r\n    ok: boolean;\r\n}\r\n\r\nconst checkResponse = (response: IResponse) => {\r\n\treturn response.ok ? response.json() : response.json().then((err: Error) => Promise.reject(err));\r\n}\r\n\r\nexport const refreshToken = () =>\r\n{\r\n    const options = {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json;charset=utf-8'\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\ttoken: getCookie('refreshToken')\r\n\t\t})\r\n\t};\r\n\r\n    return fetch('https://norma.nomoreparties.space/api/auth/token', options)\r\n\t.then(checkResponse);\r\n}\r\n\r\nexport const fetchWithRefresh = async (url: string, options: RequestInit) =>\r\n{\r\n    try\r\n    {\r\n\t\tconst res = await fetch(url, options);\r\n\t\treturn await checkResponse(res);\r\n\t}\r\n\tcatch (err)\r\n    {\r\n\t\tif (err.message === \"jwt expired\")\r\n        {\r\n\t\t\tconst refreshData = await refreshToken();\r\n\r\n\t\t\tsetCookie('refreshToken', refreshData.refreshToken);\r\n\t\t\tsetCookie('accessToken', refreshData.accessToken);\r\n\r\n            const headers = {\r\n                Authorization: refreshData.accessToken\r\n            }\r\n\r\n\t\t\toptions.headers = { ...options.headers, ...headers };\r\n            \r\n            const res = await fetch(url, options);\r\n            return await checkResponse(res);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Promise.reject(err);\r\n\t\t}\r\n\t}\r\n}","import { fetchWithRefresh } from \"../../services/fetchWithRefresh\";\r\nimport { getCookie } from \"../../utils/cookie\";\r\nimport { AppDispatch, AppThunk } from \"../reducers\";\r\nimport { IConstructorState } from \"../reducers/constructor\";\r\nimport { resetOrder } from \"./constructor\";\r\n\r\nexport const PLACE_ORDER_REQUEST = 'PLACE_ORDER_REQUEST';\r\nexport const PLACE_ORDER_ERROR = 'PLACE_ORDER_ERROR';\r\nexport const PLACE_ORDER_SUCCESS = 'PLACE_ORDER_SUCCESS';\r\n\r\nexport interface IPlaceOrderRequestAction {\r\n    readonly type: typeof PLACE_ORDER_REQUEST;\r\n}\r\n\r\nexport interface IPlaceOrderErrorAction {\r\n    readonly type: typeof PLACE_ORDER_ERROR;\r\n}\r\n\r\nexport interface IPlaceOrderSuccessAction {\r\n    readonly type: typeof PLACE_ORDER_SUCCESS;\r\n    readonly orderId: number;\r\n}\r\n\r\nexport type TPlaceOrderActions =\r\n    IPlaceOrderRequestAction |\r\n    IPlaceOrderErrorAction |\r\n    IPlaceOrderSuccessAction;\r\n\r\nexport const placeOrderRequest = (): IPlaceOrderRequestAction => ({ type: PLACE_ORDER_REQUEST });\r\n\r\nexport const placeOrderError = (): IPlaceOrderErrorAction => ({ type: PLACE_ORDER_ERROR });\r\n\r\nexport const placeOrderSuccess = (orderId: number): IPlaceOrderSuccessAction => ({ type: PLACE_ORDER_SUCCESS, orderId: orderId });\r\n\r\nexport const placeOrder: AppThunk = (currentItems: IConstructorState, setOrderModalState: (state: boolean) => void) => (dispatch: AppDispatch) =>\r\n{\r\n    const PLACE_ORDER_ENDPOINT = 'https://norma.nomoreparties.space/api/orders';\r\n\r\n    const getFullIngredients = () => {\r\n        const items = [];\r\n        \r\n        if (currentItems.items)\r\n            items.push(...currentItems.items);\r\n\r\n        if (currentItems.bun)\r\n            items.push(currentItems.bun, currentItems.bun);\r\n\r\n        return items;\r\n    }\r\n\r\n    dispatch(placeOrderRequest());\r\n    \r\n    let accessToken = getCookie('accessToken');\r\n    if (!accessToken)\r\n        accessToken = '';\r\n\r\n    setOrderModalState(true);\r\n\r\n    fetchWithRefresh(PLACE_ORDER_ENDPOINT, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': accessToken\r\n        },\r\n        body: JSON.stringify({ingredients: getFullIngredients()})\r\n    })\r\n    .then(response => {\r\n        if (response.success) {\r\n            return response;\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        const orderId: number = responseObj.order.number;\r\n        dispatch(placeOrderSuccess(orderId));\r\n        dispatch(resetOrder());\r\n        setOrderModalState(true);\r\n    })\r\n    .catch(error => {\r\n        dispatch(placeOrderError());\r\n        console.error(`Order placing error: ${error}`)\r\n    });\r\n}","import { useState, useEffect, FC } from \"react\";\r\nimport { CurrencyIcon, Button } from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport styles from './BurgerConstructor.module.css';\r\nimport IngredientsList from '../IngredientsList/IngredientsList';\r\nimport IngredientsListItem from '../IngredientsListItem/IngredientsListItem';\r\nimport { Modal } from '../Modal/Modal';\r\nimport { OrderDetails } from '../OrderDetails/OrderDetails';\r\nimport { constructorAddItem } from \"../../redux/actions/constructor\";\r\nimport { useDrop } from \"react-dnd\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { placeOrder } from \"../../redux/actions/order\";\r\nimport { setIngredient } from \"../../redux/actions/ingredient\";\r\nimport { IngredientData } from \"../../types/IIngredientData\";\r\nimport { useDispatch, useSelector } from \"../../hooks\";\r\n\r\ninterface IBuns\r\n{\r\n    first?: IngredientData | null,\r\n    last?: IngredientData | null;\r\n}\r\n\r\nconst BurgerConstructor: FC = () =>\r\n{\r\n    const [buns, setBuns] =  useState<IBuns>({ first: null, last: null });\r\n\r\n    const currentItems = useSelector(store => store.constructor)\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n\r\n        if (currentItems.bun)\r\n        {\r\n            const first = Object.assign({}, currentItems.bun);\r\n            const last = Object.assign({}, currentItems.bun);\r\n\r\n            first.name += ' (верх)';\r\n            last.name += ' (низ)';\r\n\r\n            setBuns({ first: first, last: last });\r\n            return;\r\n        }\r\n        \r\n        setBuns({ first: null, last: null });\r\n        \r\n    }, [currentItems, setBuns]);\r\n\r\n    const [orderModalState, setOrderModalState] = useState(false);\r\n\r\n    const isAuth = useSelector(store => store.access.isAuth);\r\n\r\n    const history = useHistory();\r\n\r\n    const placeOrderHandler = () => {\r\n        \r\n        if (!isAuth)\r\n        {\r\n            history.replace('/login');\r\n            return;\r\n        }\r\n\r\n        if (!(currentItems.items && currentItems.items.length) || !currentItems.bun)\r\n            return;\r\n\r\n        dispatch(placeOrder(currentItems, setOrderModalState));\r\n    }\r\n\r\n    const [, dropTarget] = useDrop({\r\n        accept: \"ingredients\",\r\n        drop(ingredientData: IngredientData) {\r\n            dispatch(constructorAddItem(ingredientData));\r\n        },\r\n    });\r\n\r\n    const onIngredientClick = (data: IngredientData) =>\r\n    {\r\n        dispatch(setIngredient(data));\r\n    }\r\n\r\n    const ingredientClickHandler = (data: IngredientData) => onIngredientClick(data);\r\n\r\n    return (\r\n        <>\r\n            <section className={`${styles.section} ml-10`}>\r\n                <div className={`${styles.scrollableList} pt-25`} ref={dropTarget}>\r\n                    {buns.first && <IngredientsListItem type=\"top\" data={buns.first} index={-1} onClickHandler={ingredientClickHandler} /> }\r\n                    {currentItems.items && currentItems.items.length > 0 && <IngredientsList items={currentItems.items} onClickHandler={ingredientClickHandler} />}\r\n                    {buns.last && <IngredientsListItem type=\"bottom\" data={buns.last} index={-1} onClickHandler={ingredientClickHandler} />}\r\n                </div>\r\n\r\n                <div className={`${styles.commitOrderWrapper} mt-10 mr-4`}>\r\n                    <span className=\"text text_type_digits-medium mr-2\">{currentItems.cost ? currentItems.cost : 0}</span>\r\n                    <CurrencyIcon type=\"primary\" />\r\n                    <div className={`ml-10 ${styles.buttonWrapper}`}>\r\n                        <Button type=\"primary\" size=\"large\" onClick={() => placeOrderHandler()}>\r\n                            Оформить заказ\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n            {orderModalState && <Modal closeHandle={() => setOrderModalState(false)}><OrderDetails /></Modal>}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default BurgerConstructor;","import { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\nimport BurgerIngredients from '../../components/BurgerIngredients/BurgerIngredients';\r\nimport BurgerConstructor from '../../components/BurgerConstructor/BurgerConstructor';\r\nimport styles from './Constructor.module.css';\r\nimport { FC } from 'react';\r\n\r\nexport const ConstructorPage: FC = () =>\r\n{\r\n    return (\r\n        <main className={styles.page}>\r\n            <DndProvider backend={HTML5Backend}>\r\n                <BurgerIngredients />\r\n                <BurgerConstructor />\r\n            </DndProvider>\r\n        </main>\r\n    )\r\n}\r\n\r\n","import { Logo, EmailInput, PasswordInput, Button } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FormEvent, FC, useState } from 'react';\r\nimport styles from './SignInForm.module.css'\r\n\r\ninterface ISignInFormProps {\r\n    handler: (email: string, password: string) => void;\r\n}\r\n\r\nexport const SignInForm: FC<ISignInFormProps> = ({ handler }) =>\r\n{\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n\r\n    const onSubmitHandler = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        handler(email, password);\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={(event: FormEvent) => onSubmitHandler(event)}>\r\n            <Logo />\r\n            <div className={`text text_type_main-medium ${styles.title} ${styles.formRow}`}>Вход</div>\r\n            <div className={styles.formRow}>\r\n                <EmailInput onChange={(event) => setEmail(event.target.value)} value={email} name={'email'} size={'default'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <PasswordInput onChange={(event) => setPassword(event.target.value)} value={password} name={'password'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <Button type=\"primary\" size=\"medium\">\r\n                    Войти\r\n                </Button>\r\n            </div>\r\n        </form>\r\n    )\r\n}","import { IUser } from \"../../types/IUser\";\r\nimport { getCookie } from \"../../utils/cookie\";\r\nimport { AppDispatch, AppThunk } from \"../reducers\";\r\nimport { History } from 'history';\r\n\r\nexport const SIGNIN_REQUEST = 'SIGNIN_REQUEST';\r\nexport const SIGNIN_SUCCESS = 'SIGNIN_SUCCESS';\r\nexport const SIGNIN_ERROR = 'SIGNIN_ERROR';\r\n\r\nexport const LOGOUT_REQUEST = 'LOGOUT_REQUEST';\r\nexport const LOGOUT_SUCCESS = 'LOGOUT_SUCCESS';\r\nexport const LOGOUT_ERROR = 'LOGOUT_ERROR';\r\n\r\nexport interface ISignInRequestAction {\r\n    readonly type: typeof SIGNIN_REQUEST;\r\n}\r\n\r\nexport interface ISignInSuccessAction {\r\n    readonly type: typeof SIGNIN_SUCCESS;\r\n    readonly accessToken: string;\r\n    readonly refreshToken: string;\r\n    user: IUser;\r\n}\r\n\r\nexport interface ISignInErrorAction {\r\n    readonly type: typeof SIGNIN_ERROR;\r\n}\r\n\r\nexport interface ILogoutRequestAction {\r\n    readonly type: typeof LOGOUT_REQUEST;\r\n}\r\n\r\nexport interface ILogoutSuccessAction {\r\n    readonly type: typeof LOGOUT_SUCCESS;\r\n}\r\n\r\nexport interface ILogoutErrorAction {\r\n    readonly type: typeof LOGOUT_ERROR;\r\n}\r\n\r\nexport type TAuthActions = \r\n    | ISignInRequestAction\r\n    | ISignInSuccessAction\r\n    | ISignInErrorAction\r\n    | ILogoutRequestAction\r\n    | ILogoutSuccessAction\r\n    | ILogoutErrorAction;\r\n\r\nexport const signInRequest = (): ISignInRequestAction => ({ type: SIGNIN_REQUEST });\r\n\r\nexport const signInSuccess = (accessToken: string, refreshToken: string, user: IUser): ISignInSuccessAction => ({\r\n    type: SIGNIN_SUCCESS,\r\n    accessToken: accessToken,\r\n    refreshToken: refreshToken,\r\n    user: user\r\n});\r\n\r\nexport const signInError = (): ISignInErrorAction => ({ type: SIGNIN_ERROR });\r\n\r\nexport const logoutRequest = (): ILogoutRequestAction => ({ type: LOGOUT_REQUEST });\r\n\r\nexport const logoutSuccess = (): ILogoutSuccessAction => ({ type: LOGOUT_SUCCESS });\r\n\r\nexport const logoutError = (): ILogoutErrorAction => ({ type: LOGOUT_ERROR });\r\n\r\nconst loginRequest = async (email: string, password: string) =>\r\n{\r\n    return await fetch('https://norma.nomoreparties.space/api/auth/login', {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        cache: 'no-cache',\r\n        credentials: 'same-origin',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        redirect: 'follow',\r\n        referrerPolicy: 'no-referrer',\r\n        body: JSON.stringify({ email: email, password: password })\r\n    });\r\n};\r\n\r\nexport const signIn: AppThunk = (email: string, password: string) => (dispatch: AppDispatch) =>\r\n{\r\n    dispatch(signInRequest());\r\n\r\n    loginRequest(email, password)\r\n    .then(response => {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(signInSuccess(responseObj.accessToken, responseObj.refreshToken, responseObj.user));\r\n    })\r\n    .catch(error => {\r\n        dispatch(signInError());\r\n        console.error(`Signin error: ${error}`)\r\n    });\r\n}\r\n\r\nconst logout = async () =>\r\n{\r\n    const refreshToken = getCookie('refreshToken');\r\n\r\n    return await fetch('https://norma.nomoreparties.space/api/auth/logout', {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        cache: 'no-cache',\r\n        credentials: 'same-origin',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        redirect: 'follow',\r\n        referrerPolicy: 'no-referrer',\r\n        body: JSON.stringify({ token: refreshToken })\r\n    });\r\n};\r\n\r\nexport const signOut: AppThunk = (history: History) => (dispatch: AppDispatch) =>\r\n{\r\n    let refreshToken: string | undefined = getCookie('refreshToken');\r\n    if (!refreshToken)\r\n        refreshToken = '';\r\n    dispatch(logoutRequest());\r\n\r\n    logout()\r\n    .then(response => {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(() => {\r\n        dispatch(logoutSuccess());\r\n        history.replace('/login');\r\n    })\r\n    .catch(error => {\r\n        dispatch(logoutError());\r\n        console.error(`Logout error: ${error}`)\r\n    });\r\n};","import { Link, Redirect } from 'react-router-dom';\r\nimport styles from './SignIn.module.css'\r\nimport './SignIn.css';\r\nimport { SignInForm } from '../../components/SignInForm/SignInForm';\r\nimport '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { useLocation } from 'react-router-dom';\r\nimport { signIn } from '../../redux/actions/auth';\r\nimport { FC } from 'react';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\n\r\ninterface StateType {\r\n    from: { pathname: string }\r\n}\r\n\r\nexport const SignInPage: FC = () =>\r\n{\r\n    const { state } = useLocation<StateType>();\r\n    const dispatch = useDispatch();\r\n\r\n    const isAuth = useSelector(store => store.access.isAuth);\r\n\r\n    if (isAuth) {\r\n        return (\r\n            <Redirect\r\n                to={{\r\n                    pathname: state ? state.from.pathname : '/'\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={\"signin-cont\"}>\r\n            <div>\r\n                <SignInForm handler={(email: string, password: string) => dispatch(signIn(email, password))} />\r\n                <div className={styles.links}>\r\n                    <div className={styles.linksRow}>\r\n                        <span className={'text text_type_main-default text_color_inactive'}>Вы - новый пользователь?</span>\r\n                        <Link to='/register'>\r\n                            <span className={`text text_type_main-default ${styles.blueLink}`}>\r\n                                Зарегистрироваться\r\n                            </span>\r\n                        </Link>\r\n                    </div>\r\n                    <div className={styles.linksRow}>\r\n                        <span className={'text text_type_main-default text_color_inactive'}>Забыли пароль?</span>\r\n                        <Link to='/forgot-password'>\r\n                            <span className={`text text_type_main-default ${styles.blueLink}`}>\r\n                                Восстановить пароль\r\n                            </span>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import { Logo, EmailInput, PasswordInput, Input, Button } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FormEvent, FC, useState } from 'react';\r\nimport styles from './RegisterForm.module.css'\r\n\r\ninterface IRegisterFormProps {\r\n    handler: (email: string, password: string, name: string) => void;\r\n}\r\n\r\nexport const RegisterForm: FC<IRegisterFormProps> = ( { handler }) =>\r\n{\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [name, setName] = useState('');\r\n\r\n    const onSubmitHandler = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        handler(email, password, name);\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={(event: FormEvent) => onSubmitHandler(event)}>\r\n            <Logo />\r\n            <div className={`text text_type_main-medium ${styles.title} ${styles.formRow}`}>Регистрация</div>\r\n            <div className={styles.formRow}>\r\n                <Input onChange={(event) => setName(event.target.value)} value={name} name={'name'} size={'default'} placeholder={'Имя'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <EmailInput onChange={(event) => setEmail(event.target.value)} value={email} name={'email'} size={'default'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <PasswordInput onChange={(event) => setPassword(event.target.value)} value={password} name={'password'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <Button type=\"primary\" size=\"medium\">\r\n                    Зарегистрироваться\r\n                </Button>\r\n            </div>    \r\n        </form>\r\n    )\r\n}","import { IUser } from \"../../types/IUser\";\r\nimport { setCookie } from \"../../utils/cookie\";\r\nimport { AppDispatch, AppThunk } from \"../reducers\";\r\nimport { History } from 'history';\r\n\r\nexport const REGISTER_REQUEST = 'REGISTER_REQUEST';\r\nexport const REGISTER_SUCCESS = 'REGISTER_SUCCESS';\r\nexport const REGISTER_ERROR = 'REGISTER_ERROR';\r\n\r\nexport interface IRegisterRequestAction {\r\n    readonly type: typeof REGISTER_REQUEST;\r\n}\r\n\r\nexport interface IRegisterSuccessAction\r\n{\r\n    readonly type: typeof REGISTER_SUCCESS;\r\n    readonly accessToken: string;\r\n    readonly refreshToken: string;\r\n    user: IUser;\r\n}\r\n\r\nexport interface IRegisterErrorAction {\r\n    readonly type: typeof REGISTER_ERROR;\r\n}\r\n\r\nexport type TRegisterActions = \r\n    | IRegisterRequestAction\r\n    | IRegisterSuccessAction\r\n    | IRegisterErrorAction;\r\n\r\nexport const registerRequest = (): IRegisterRequestAction => ({ type: REGISTER_REQUEST });\r\n\r\nexport const registerSuccess = (accessToken: string, refreshToken: string, user: IUser): IRegisterSuccessAction => ({\r\n    type: REGISTER_SUCCESS,\r\n    accessToken: accessToken,\r\n    refreshToken: refreshToken,\r\n    user: user\r\n});\r\n\r\nexport const registerError = (): IRegisterErrorAction => ({ type: REGISTER_ERROR });\r\n\r\nexport const register: AppThunk = (email: string, password: string, name: string, history: History) => (dispatch: AppDispatch) =>\r\n{\r\n    const END_POINT: string = 'https://norma.nomoreparties.space/api/auth/register';\r\n    \r\n    dispatch(registerRequest());\r\n\r\n    fetch(END_POINT, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ email: email, password: password, name: name })\r\n    })\r\n    .then(response => {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(registerSuccess(responseObj.accessToken, responseObj.refreshToken, responseObj.user));\r\n        history.replace('/');\r\n        setCookie('refreshToken', responseObj.refreshToken);\r\n    })\r\n    .catch(error => {\r\n        dispatch(registerError());\r\n        console.error(`Register error: ${error}`)\r\n    });\r\n}","import { Link, Redirect, useHistory } from 'react-router-dom';\r\nimport styles from './Register.module.css'\r\nimport './Register.css';\r\nimport { RegisterForm } from '../../components/RegisterForm/RegisterForm';\r\nimport '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { register } from '../../redux/actions/register';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\nexport const RegisterPage: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const history = useHistory();\r\n\r\n    const registerHandler = (email: string, password: string, name: string) => {\r\n        dispatch(register(email, password, name, history));   \r\n    }\r\n\r\n    const isAuth = useSelector(store => store.access.isAuth);\r\n\r\n    if (isAuth) {\r\n        return (\r\n            <Redirect\r\n                to={{\r\n                    pathname: '/'\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={\"page-cont\"}>\r\n            <div className={styles.center}>\r\n                <RegisterForm handler={(email: string, password: string, name: string) => registerHandler(email, password, name)} />\r\n                <div className={styles.links}>\r\n                    <div className={styles.linksRow}>\r\n                        <span className={'text text_type_main-default text_color_inactive'}>Уже зарегистрированы?</span>\r\n                        <Link to='/login'>\r\n                            <span className={`text text_type_main-default ${styles.blueLink}`}>\r\n                                Войти\r\n                            </span>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import { Logo, EmailInput, Button } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FormEvent, FC, useState } from 'react';\r\nimport styles from './ForgotPasswordForm.module.css'\r\n\r\ninterface IForgotPasswordFormProps {\r\n    handler: (email: string) => void\r\n}\r\n\r\nexport const ForgotPasswordForm: FC<IForgotPasswordFormProps> = ({ handler }) =>\r\n{\r\n    const [email, setEmail] = useState('');\r\n\r\n    const onSubmitHandler = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        handler(email);\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={(event: FormEvent) => onSubmitHandler(event)}>\r\n            <Logo />\r\n            <div className={`text text_type_main-medium ${styles.title} ${styles.formRow}`}>Восстановление пароля</div>\r\n            <div className={styles.formRow}>\r\n                <EmailInput onChange={(event) => setEmail(event.target.value)} value={email} name={'email'} size={'default'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <Button type=\"primary\" size=\"medium\">\r\n                    Восстановить\r\n                </Button>\r\n            </div>\r\n        </form>\r\n    )\r\n}","import { AppDispatch, AppThunk } from \"../reducers\";\r\nimport { History } from 'history';\r\n\r\nexport const INIT_RESET_PASSWORD_REQUEST = 'INIT_RESET_PASSWORD_REQUEST';\r\nexport const INIT_RESET_PASSWORD_SUCCESS = 'INIT_RESET_PASSWORD_SUCCESS';\r\nexport const INIT_RESET_PASSWORD_ERROR = 'INIT_RESET_PASSWORD_ERROR';\r\n\r\nexport interface IInitResetPasswordRequestAction {\r\n    readonly type: typeof INIT_RESET_PASSWORD_REQUEST;\r\n}\r\n\r\nexport interface IInitResetPasswordSuccessAction {\r\n    readonly type: typeof INIT_RESET_PASSWORD_SUCCESS;\r\n    readonly message: string;\r\n}\r\n\r\nexport interface IInitResetPasswordErrorAction {\r\n    readonly type: typeof INIT_RESET_PASSWORD_ERROR;\r\n}\r\n\r\nexport type TInitResetPasswordActions =\r\n    IInitResetPasswordRequestAction |\r\n    IInitResetPasswordSuccessAction |\r\n    IInitResetPasswordErrorAction;\r\n\r\nexport const initResetPasswordRequest = (): IInitResetPasswordRequestAction => ({ type: INIT_RESET_PASSWORD_REQUEST });\r\n\r\nexport const initResetPasswordSuccess = (message: string): IInitResetPasswordSuccessAction => ({ type: INIT_RESET_PASSWORD_SUCCESS, message: message });\r\n\r\nexport const initResetPasswordError = (): IInitResetPasswordErrorAction => ({ type: INIT_RESET_PASSWORD_ERROR });\r\n\r\nexport const initResetPassword: AppThunk = (email: string, history: History) => (dispatch: AppDispatch) =>\r\n{\r\n    const END_POINT: string = 'https://norma.nomoreparties.space/api/password-reset';\r\n    \r\n    dispatch(initResetPasswordRequest());\r\n\r\n    fetch(END_POINT, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ email: email })\r\n    })\r\n    .then(response => {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(initResetPasswordSuccess(responseObj.message));\r\n        history.push('/reset-password', {from: history.location});\r\n    })\r\n    .catch(error => {\r\n        dispatch(initResetPasswordError());\r\n        console.error(`Reset password error: ${error}`)\r\n    });\r\n}","import styles from './ForgotPassword.module.css'\r\nimport './ForgotPassword.css';\r\nimport { ForgotPasswordForm } from '../../components/ForgotPasswordForm/ForgotPasswordForm';\r\nimport '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { Link, Redirect, useHistory } from 'react-router-dom';\r\nimport { initResetPassword } from '../../redux/actions/initResetPassword';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\nexport const ForgotPasswordPage: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const history = useHistory();\r\n\r\n    const initResetPasswordHandler = (email: string) => {\r\n        dispatch(initResetPassword(email, history));\r\n    }\r\n\r\n    const isAuth = useSelector(store => store.access.isAuth);\r\n\r\n    if (isAuth) {\r\n        return (\r\n            <Redirect\r\n                to={{\r\n                    pathname: '/'\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={\"page-cont\"}>\r\n            <div className={styles.center}>\r\n                <ForgotPasswordForm handler={(email: string) => initResetPasswordHandler(email)} />\r\n                <div className={styles.links}>\r\n                    <div className={styles.linksRow}>\r\n                        <span className={'text text_type_main-default text_color_inactive'}>Вспомнили пароль?</span>\r\n                        <Link to='/login'>\r\n                            <span className={`text text_type_main-default ${styles.blueLink}`}>\r\n                                Войти\r\n                            </span>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import { Logo, PasswordInput, Input, Button } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FormEvent, FC, useState } from 'react';\r\nimport styles from './ResetPasswordForm.module.css'\r\n\r\ninterface IResetPasswordFormProps {\r\n    handler: (password: string, token: string) => void;\r\n}\r\n\r\nexport const ResetPasswordForm: FC<IResetPasswordFormProps> = ({ handler }) =>\r\n{\r\n    const [password, setPassword] = useState('');\r\n    const [token, setToken] = useState('');\r\n\r\n    const onSubmitHandler = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        handler(password, token);\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={(event: FormEvent) => onSubmitHandler(event)}>\r\n            <Logo />\r\n            <div className={`text text_type_main-medium ${styles.title} ${styles.formRow}`}>Восстановление пароля</div>\r\n            <div className={styles.formRow}>\r\n                <PasswordInput onChange={(event) => setPassword(event.target.value)} value={password} name={'password'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <Input onChange={(event) => setToken(event.target.value)} value={token} name={'code'} size={'default'} placeholder={'Введите код из письма'} />\r\n            </div>\r\n            <div className={styles.formRow}>\r\n                <Button type=\"primary\" size=\"medium\">\r\n                    Восстановить\r\n                </Button>\r\n            </div>\r\n        </form>\r\n    )\r\n}","import { AppDispatch, AppThunk } from \"../reducers\";\r\nimport { History } from 'history';\r\n\r\nexport const RESET_PASSWORD_REQUEST = 'RESET_PASSWORD_REQUEST';\r\nexport const RESET_PASSWORD_SUCCESS = 'RESET_PASSWORD_SUCCESS';\r\nexport const RESET_PASSWORD_ERROR = 'RESET_PASSWORD_ERROR';\r\n\r\nexport interface IResetPasswordRequestAction {\r\n    readonly type: typeof RESET_PASSWORD_REQUEST;\r\n}\r\n\r\nexport interface IResetPasswordSuccessAction {\r\n    readonly type: typeof RESET_PASSWORD_SUCCESS;\r\n    readonly message: string;\r\n}\r\n\r\nexport interface IResetPasswordErrorAction {\r\n    readonly type: typeof RESET_PASSWORD_ERROR;\r\n}\r\n\r\nexport type TResetPasswordActions =\r\n    IResetPasswordRequestAction |\r\n    IResetPasswordSuccessAction |\r\n    IResetPasswordErrorAction;\r\n\r\nexport const resetPasswordRequest = (): IResetPasswordRequestAction => ({ type: RESET_PASSWORD_REQUEST });\r\n\r\nexport const resetPasswordSuccess = (message: string): IResetPasswordSuccessAction => ({ type: RESET_PASSWORD_SUCCESS, message: message });\r\n\r\nexport const resetPasswordError = (): IResetPasswordErrorAction => ({ type: RESET_PASSWORD_ERROR });\r\n\r\nexport const resetPassword: AppThunk = (password: string, token: string, history: History) => (dispatch: AppDispatch) =>\r\n{\r\n    const END_POINT = 'https://norma.nomoreparties.space/api/password-reset/reset';\r\n\r\n    dispatch(resetPasswordRequest());\r\n    \r\n    fetch(END_POINT, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ password: password, token: token })\r\n    })\r\n    .then(response => {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(resetPasswordSuccess(responseObj.message));\r\n        history.replace('/login');\r\n    })\r\n    .catch(error => {\r\n        dispatch(resetPasswordError());\r\n        console.error(`Reset password error: ${error}`)\r\n    });\r\n}","import styles from './ResetPassword.module.css'\r\nimport './ResetPassword.css';\r\nimport { ResetPasswordForm } from '../../components/ResetPasswordForm/ResetPasswordForm';\r\nimport '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { Link, Redirect, useHistory, useLocation } from 'react-router-dom';\r\nimport { resetPassword } from '../../redux/actions/resetPassword';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\ninterface stateType {\r\n    from: { pathname: string }\r\n}\r\n\r\nexport const ResetPasswordPage: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const history = useHistory();\r\n\r\n    const resetPasswordHandler = (password: string, token: string) => {\r\n        dispatch(resetPassword(password, token, history));\r\n    }\r\n\r\n    const isAuth = useSelector(store => store.access.isAuth);\r\n\r\n    const { state } = useLocation<stateType>();\r\n\r\n    if (isAuth || state === undefined || (state && state.from.pathname !== '/forgot-password')) {\r\n        return (\r\n            <Redirect\r\n                to={{\r\n                    pathname: '/'\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={\"page-cont\"}>\r\n            <div className={styles.center}>\r\n                <ResetPasswordForm handler={(password: string, token: string) => resetPasswordHandler(password, token)} />\r\n                <div className={styles.links}>\r\n                    <div className={styles.linksRow}>\r\n                        <span className={'text text_type_main-default text_color_inactive'}>Вспомнили пароль?</span>\r\n                        <Link to='/login'>\r\n                            <span className={`text text_type_main-default ${styles.blueLink}`}>\r\n                                Войти\r\n                            </span>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import { IngredientData } from '../../types/IIngredientData';\r\nimport { ADD_ITEM, REMOVE_ITEM, REORDER_ITEM, RESET_ORDER, TConstructorActions } from '../actions/constructor';\r\n\r\nexport interface IConstructorState {\r\n    items: IngredientData[];\r\n    bun: IngredientData | null;\r\n    cost: number;\r\n}\r\n\r\nconst constructorInitState: IConstructorState = {\r\n    items: [],\r\n    bun: null,\r\n    cost: 0\r\n};\r\n\r\nexport const orderCostReducer = (items: IngredientData[], bun: IngredientData | null): number =>\r\n{\r\n    let costValue: number = 0;\r\n    \r\n    costValue += items?.reduce((acc: number, item: IngredientData) => {\r\n        return acc + item.price;\r\n    }, 0);\r\n\r\n    if (bun)\r\n        costValue += 2 * bun.price;\r\n\r\n    return costValue;\r\n}\r\n\r\nexport const constructorReducer = (state: IConstructorState = constructorInitState, action: TConstructorActions): IConstructorState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case ADD_ITEM:\r\n        {\r\n            const items = state.items ? [...state.items] : [];\r\n            const item: IngredientData = action.item;\r\n\r\n            if (item.type === 'bun')\r\n                return {items: [...items], bun: item, cost: orderCostReducer(items, item) };\r\n            \r\n            return {...state, items: [...items, action.item], cost: orderCostReducer([...items, action.item], state.bun) };\r\n        }\r\n\r\n        case REMOVE_ITEM:\r\n        {\r\n            const items = [...state.items];\r\n            items.splice(action.index, 1);\r\n            return {...state, items: items, cost: orderCostReducer(items, state.bun) };\r\n        }\r\n\r\n        case REORDER_ITEM:\r\n        {\r\n            const items = [...state.items];\r\n            const data = items[action.prevIndex];\r\n            \r\n            items.splice(action.prevIndex, 1);\r\n            items.splice(action.newIndex, 0, data);\r\n\r\n            return {...state, items: items };\r\n        }\r\n\r\n        case RESET_ORDER:\r\n            return { items: [], bun: null, cost: 0 };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import moment from \"moment\";\r\n\r\nexport const formatOrderDate = (date: Date | null): string =>\r\n{\r\n    if (!date)\r\n        return \"\";\r\n\r\n    const formats = {\r\n        sameDay: '[Сегодня], HH:mm Z',\r\n        lastDay: '[Вчера], HH:mm Z',\r\n        lastWeek: 'DD.MM.YYYY HH:mm Z',\r\n        sameElse: 'DD.MM.YYYY HH:mm Z'\r\n    }\r\n\r\n    return moment(new Date(date)).calendar(formats)\r\n}","import { IngredientData } from \"../../types/IIngredientData\";\r\nimport { AppDispatch, AppThunk } from \"../reducers\";\r\nimport { IIngredientsLibState } from \"../reducers/ingredientsLib\";\r\nimport { IOrderDetailsData } from \"../reducers/orderDetails\";\r\n\r\nexport const SET_ORDER_DETAIL = 'SET_ORDER_DETAIL';\r\n\r\nexport const GET_ORDER_BY_ID_REQUEST = 'GET_ORDER_BY_ID_REQUEST';\r\nexport const GET_ORDER_BY_ID_SUCCESS = 'GET_ORDER_BY_ID_SUCCESS';\r\nexport const GET_ORDER_BY_ID_ERROR = 'GET_ORDER_BY_ID_ERROR';\r\n\r\nexport interface ISetOrderDetailAction {\r\n    readonly type: typeof SET_ORDER_DETAIL;\r\n    readonly orderData: IOrderDetailsData;\r\n}\r\n\r\nexport interface IGetOrderByIdRequestAction {\r\n    readonly type: typeof GET_ORDER_BY_ID_REQUEST;\r\n}\r\n\r\nexport interface IGetOrderByIdSuccessAction {\r\n    readonly type: typeof GET_ORDER_BY_ID_SUCCESS;\r\n    readonly orderData: IOrderDetailsData | null;\r\n}\r\n\r\nexport interface IGetOrderByIdErrorAction {\r\n    readonly type: typeof GET_ORDER_BY_ID_ERROR;\r\n}\r\n\r\nexport type TOrderDetailsActions =\r\n    ISetOrderDetailAction |\r\n    IGetOrderByIdRequestAction |\r\n    IGetOrderByIdSuccessAction |\r\n    IGetOrderByIdErrorAction;\r\n\r\nexport const setOrderDetail = (orderData: IOrderDetailsData): ISetOrderDetailAction => ({ type: SET_ORDER_DETAIL, orderData: orderData });\r\n\r\nexport const getOrderByIdRequest = (): IGetOrderByIdRequestAction => ({ type: GET_ORDER_BY_ID_REQUEST });\r\n\r\nexport const getOrderByIdSuccess = (orderData: IOrderDetailsData | null): IGetOrderByIdSuccessAction => ({ type: GET_ORDER_BY_ID_SUCCESS, orderData: orderData });\r\n\r\nexport const getOrderByIdError = (): IGetOrderByIdErrorAction => ({ type: GET_ORDER_BY_ID_ERROR });\r\n\r\nexport const getOrderById: AppThunk = (id: number, lib: IIngredientsLibState) => (dispatch: AppDispatch) =>\r\n{\r\n    const END_POINT: string = `https://norma.nomoreparties.space/api/orders/${id}`;\r\n    \r\n    dispatch(getOrderByIdRequest());\r\n\r\n    fetch(END_POINT,\r\n    {\r\n        method: 'GET',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    })\r\n    .then(response =>\r\n    {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj =>\r\n    {\r\n        let orderData: IOrderDetailsData | null = null;\r\n        let ingredientsIds: string[] = [];\r\n\r\n        if (responseObj.orders?.length)\r\n        {\r\n            orderData = responseObj.orders[0];\r\n            ingredientsIds = responseObj.orders[0].ingredients;\r\n\r\n            if (orderData)\r\n                orderData.ingredients = ingredientsIds.filter(item => item !== null && item !== undefined).map(id => {\r\n                    const item: IngredientData | undefined = lib.itemsById?.get(id);\r\n                    return item;\r\n                }) as IngredientData[];\r\n        }\r\n\r\n        dispatch(getOrderByIdSuccess(orderData));\r\n    })\r\n    .catch(error =>\r\n    {\r\n        dispatch(getOrderByIdError());\r\n        console.error(`Get order by id error: ${error}`)\r\n    });\r\n}","import { CurrencyIcon } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport styles from './OrderListItem.module.css'\r\nimport { orderCostReducer } from '../../redux/reducers/constructor';\r\nimport { formatOrderDate } from '../../redux/reducers/utils';\r\nimport { setOrderDetail } from '../../redux/actions/orderDetails';\r\nimport { useLocation } from 'react-router';\r\nimport { Link } from 'react-router-dom';\r\nimport { FC, useEffect, useState } from 'react';\r\nimport { OrderStatus } from '../../types/IOrderData';\r\nimport { IngredientData } from '../../types/IIngredientData';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\n\r\ninterface IOrderListItemProps {\r\n    name: string\r\n    number: number,\r\n    _ingredients: string[];\r\n    date: Date;\r\n    status: OrderStatus;\r\n}\r\n\r\nconst OrderListItem: FC<IOrderListItemProps> = ({name, number, _ingredients, date, status }: IOrderListItemProps) =>\r\n{\r\n    const MAX_NAME_LENGTH: number = 65;\r\n    \r\n    const [cost, setCost] = useState(0);\r\n    const [ingredients, setIngredients] = useState<IngredientData[]>([]);\r\n\r\n    const lib = useSelector(store => store.ingredientsLib.itemsById);\r\n\r\n    useEffect(() => {\r\n        const orderIngredients: IngredientData[] = _ingredients.filter(item => item !== null && item !== undefined).map(id => lib?.get(id)) as IngredientData[];\r\n        setIngredients(orderIngredients);\r\n        setCost(orderCostReducer(orderIngredients.slice(1, orderIngredients.length), orderIngredients[0]));\r\n    }, [lib, _ingredients]);\r\n\r\n    const ingredientsCont = () => {\r\n\r\n        const ingredientsCount = ingredients.length;\r\n        const MAX_COUNT: number = 6;\r\n        const overCount: number = Math.max(0, ingredientsCount - MAX_COUNT);\r\n\r\n        return (\r\n            <div className={styles.ingredintsRow}>\r\n                {ingredients.slice(0, MAX_COUNT).map((item: IngredientData, index: number) => {\r\n                    const style = {\r\n                        backgroundImage: `url(${item.image_mobile})`,\r\n                        zIndex: ingredientsCount - index\r\n                    };\r\n                    return <div\r\n                        key={index}\r\n                        style={style}\r\n                        className={`${styles.ingredientImage} text text_type_digits-default`}>\r\n                            {index + 1 === MAX_COUNT && overCount ? <span className={styles.overCount}>+{overCount}</span> : \"\"}\r\n                    </div>;\r\n                })}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const location = useLocation();\r\n\r\n    const orderSelect = () => {\r\n        dispatch(setOrderDetail({name, number, ingredients, date, status }));\r\n    }\r\n\r\n    if (!ingredients || !ingredients.length)\r\n        return null;\r\n    \r\n    let statusName, statusClassName;\r\n\r\n    switch (status)\r\n    {\r\n        case 'done': statusName = 'Выполнен'; statusClassName = styles.statusDone ; break;\r\n        case 'pending': statusName = 'В работе'; statusClassName = styles.statusPending ; break;\r\n        case 'created': statusName = 'Принят'; statusClassName = styles.statusCreated ; break;\r\n        case 'canceled': statusName = 'Отменен'; statusClassName = styles.statusCancled ; break;\r\n    }\r\n\r\n    return (\r\n\r\n        <Link className={styles.cont} onClick={() => orderSelect()} to={{\r\n            pathname: `${location.pathname}/${number}`,\r\n            state: {background: location}\r\n        }}>\r\n            <div className={styles.top}>\r\n                <span className='text text_type_digits-default'>{`#${number}`}</span>\r\n                <span className='text text_type_main-default text_color_inactive'>{formatOrderDate(date)}</span>\r\n            </div>\r\n            <div className={`${statusClassName} text text_type_default-default`}>\r\n                {statusName}\r\n            </div>\r\n            <div className={`${styles.name} text text_type_main-medium`}>\r\n                {name.substr(0, MAX_NAME_LENGTH)}\r\n            </div>\r\n            <div className={styles.bottom}>\r\n                <div>{ingredientsCont()}</div>\r\n                <div className={styles.priceCont}>\r\n                    <span className={`${styles.cost} text text_type_digits-default`}>{cost}</span>\r\n                    <CurrencyIcon type=\"primary\" />\r\n                </div>\r\n            </div>\r\n        </Link>\r\n    )\r\n}\r\n\r\nexport default OrderListItem;","import styles from './OrdersList.module.css';\r\nimport '@ya.praktikum/react-developer-burger-ui-components';\r\nimport OrderListItem from '../OrderListItem/OrderListItem';\r\nimport { IOrdersFeed } from '../../types/IOrderData';\r\nimport { useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\nexport interface IOrdersListProps {\r\n    caption?: string;\r\n    type: 'small' | 'large';\r\n    feed: IOrdersFeed | null;\r\n}\r\n\r\nexport const OrdersList: FC<IOrdersListProps> = ( { caption, type, feed }) =>\r\n{\r\n    const lib = useSelector(store => store.ingredientsLib.items);\r\n\r\n    const sectionClassName = type === 'small' ? styles.smallSection : styles.largeSection;\r\n\r\n    return (\r\n        <section className={`${sectionClassName} ${styles.section}`}>\r\n            {caption && <div className=\"text text_type_main-large pt-10 pb-5\">{caption}</div>}\r\n            {lib?.length > 0 && <div className={styles.itemsCont}>\r\n                {feed?.orders?.map(order => {\r\n                    return <OrderListItem\r\n                        key={order._id}\r\n                        name={order.name}\r\n                        number={order.number}\r\n                        status={order.status}\r\n                        _ingredients={order.ingredients}\r\n                        date={order.updatedAt ? order.updatedAt : order.createdAt} />\r\n                })}\r\n            </div>}\r\n        </section>   \r\n    )\r\n}","import styles from './OrdersStat.module.css';\r\nimport '@ya.praktikum/react-developer-burger-ui-components';\r\nimport { IOrderData } from '../../types/IOrderData';\r\nimport { FC, useEffect, useState } from 'react';\r\nimport { useSelector } from '../../hooks';\r\n\r\nexport const OrdersStat: FC = () =>\r\n{\r\n    const MAX_ORDERS_COUNT: number = 16;\r\n\r\n    const [completedOrders, setCompletedOrders] = useState<number[]>([]);\r\n    const [prcessingOrders, setPrcessingOrders] = useState<number[]>([]);\r\n\r\n    const feed = useSelector(store => store.feedWs.feed);\r\n\r\n    useEffect(() => {\r\n        \r\n        if (!feed)\r\n            return;\r\n\r\n        const completed = feed.orders.filter((order: IOrderData) => order.status === 'done' ).map((order: IOrderData) => order.number);\r\n        completed && setCompletedOrders(completed.slice(0, MAX_ORDERS_COUNT));\r\n        \r\n        const processing = feed.orders.filter((order: IOrderData) => order.status !== 'done').map((order: IOrderData) => order.number);\r\n        processing && setPrcessingOrders(processing.slice(0, MAX_ORDERS_COUNT));\r\n    }, [feed]);\r\n\r\n    return (\r\n        <section className={`${styles.section}  ml-10`}>\r\n            <div className='text text_type_main-large pt-10 pb-5'>Статистика</div>\r\n            <div className={styles.statOper}>\r\n                <div className={styles.statOperCol}>\r\n                    <div className='text text_type_main-medium'>Готовы:</div>\r\n                    <div className={styles.statOrderList}>\r\n                        \r\n                        { completedOrders?.map((orderId: number, index: number) => (\r\n                            <div key={index} className={`text text_type_digits-default mt-2 ${styles.completedOrder}`}>{orderId}</div>\r\n                        )) }\r\n                    </div>\r\n                </div>\r\n                <div className={styles.statOperCol}>\r\n                    <div className='text text_type_main-medium'>В работе:</div>\r\n                    <div className={styles.statOrderList}>\r\n                        { prcessingOrders?.map((orderId: number, index: number) => (\r\n                            <div key={index} className={`text text_type_digits-default mt-2`}>{orderId}</div>\r\n                        )) }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={styles.statCont}>\r\n                <span className='text text_type_main-medium'>\r\n                    Выполнено за все время:\r\n                </span>\r\n                <div className={`text text_type_digits-large ${styles.digitsLarge}`}>{feed?.total}</div>\r\n            </div>\r\n            <div className={styles.statCont}>\r\n                <span className='text text_type_main-medium'>\r\n                    Выполнено за сегодня:\r\n                </span>\r\n                <div className={`text text_type_digits-large ${styles.digitsLarge}`}>{feed?.totalToday}</div>\r\n            </div>\r\n        </section>   \r\n    )\r\n}","import { WebSocketAction } from \"../middlewares/wsMiddleware\";\r\n\r\nexport const FEED_WS_CONNECTION_START = 'FEED_WS_CONNECTION_START';\r\nexport const FEED_WS_CONNECTION_SUCCESS = 'FEED_WS_CONNECTION_SUCCESS';\r\nexport const FEED_WS_CONNECTION_ERROR = 'FEED_WS_CONNECTION_ERROR';\r\nexport const FEED_WS_CONNECTION_CLOSED = 'FEED_WS_CONNECTION_CLOSED';\r\nexport const FEED_WS_GET_MESSAGE = 'FEED_WS_GET_MESSAGE';\r\n\r\nexport interface IFeedWsConnectionStartAction extends WebSocketAction {\r\n    readonly type: typeof FEED_WS_CONNECTION_START;\r\n}\r\n\r\nexport interface IFeedWsConnectionSuccessAction extends WebSocketAction {\r\n    readonly type: typeof FEED_WS_CONNECTION_SUCCESS;\r\n}\r\n\r\nexport interface IFeedWsConnectionErrorAction extends WebSocketAction {\r\n    readonly type: typeof FEED_WS_CONNECTION_ERROR;\r\n    readonly payload: string;\r\n}\r\n\r\nexport interface IFeedWsConnectionClosedAction extends WebSocketAction {\r\n    readonly type: typeof FEED_WS_CONNECTION_CLOSED;\r\n    readonly payload: string;\r\n}\r\n\r\nexport interface IFeedWsGetMessageAction extends WebSocketAction {\r\n    readonly type: typeof FEED_WS_GET_MESSAGE;\r\n    readonly payload: string;\r\n}\r\n\r\nexport type TFeedWsActions =\r\n    IFeedWsConnectionStartAction |\r\n    IFeedWsConnectionSuccessAction |\r\n    IFeedWsConnectionErrorAction |\r\n    IFeedWsConnectionClosedAction |\r\n    IFeedWsGetMessageAction;\r\n\r\nexport const feedWsConnectionStart = (): IFeedWsConnectionStartAction => ({ type: FEED_WS_CONNECTION_START });\r\n\r\nexport const feedWsConnectionSuccess = (): IFeedWsConnectionSuccessAction => ({ type: FEED_WS_CONNECTION_SUCCESS });\r\n\r\nexport const feedWsConnectionError = (payload: string): IFeedWsConnectionErrorAction => ({ type: FEED_WS_CONNECTION_ERROR, payload: payload });\r\n\r\nexport const feedWsConnectionClosed = (payload: string): IFeedWsConnectionClosedAction => ({ type: FEED_WS_CONNECTION_CLOSED, payload: payload });\r\n\r\nexport const feedWsGetMessage = (message: string): IFeedWsGetMessageAction => ({ type: FEED_WS_GET_MESSAGE, payload: message });","import styles from './OrdersFeed.module.css';\r\nimport '@ya.praktikum/react-developer-burger-ui-components';\r\nimport { OrdersList } from '../../components/OrdersList/OrdersList';\r\nimport { OrdersStat } from '../../components/OrdersStat/OrdersStat';\r\nimport { FC, useEffect } from 'react';\r\nimport { feedWsConnectionStart } from '../../redux/actions/feedWsActions';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\n\r\nexport const OrdersFeedPage: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const feed = useSelector(store => store.feedWs.feed);\r\n\r\n    useEffect(() => {\r\n        dispatch(feedWsConnectionStart());\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <div className={styles.page}>\r\n            <OrdersList caption='Лента заказов' type='small' feed={feed} />\r\n            <OrdersStat />\r\n        </div>\r\n    )\r\n}","import '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FC } from 'react';\r\nimport { Link, useHistory, useLocation } from 'react-router-dom';\r\nimport { signOut } from '../../redux/actions/auth';\r\nimport { useDispatch } from '../../hooks';\r\nimport styles from './ProfileMenu.module.css';\r\n\r\nexport const ProfileMenu: FC = () =>\r\n{\r\n    const location = useLocation();\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n\r\n    const isProfile: boolean = location.pathname === '/profile';\r\n    const isOrders: boolean = location.pathname === '/profile/orders';\r\n\r\n    const profileCont = (\r\n        <div className={`text text_type_main-medium ${ isProfile ? '' : 'text_color_inactive' } ${styles.caption}`}>\r\n            Профиль\r\n        </div>\r\n    );\r\n\r\n    const ordersCont = (\r\n        <div className={`text text_type_main-medium ${ isOrders ? '' : 'text_color_inactive' } ${styles.caption}`}>\r\n            История заказов\r\n        </div>\r\n    );\r\n\r\n    const logout = async () => {\r\n        dispatch(signOut(history));\r\n    }\r\n\r\n    return (\r\n        <div className={styles.column}>\r\n            {!isProfile ? <Link to='/profile'>{profileCont}</Link> : profileCont}\r\n            {!isOrders ? <Link to='/profile/orders'>{ordersCont}</Link> : ordersCont}\r\n\r\n            <div className={`text text_type_main-medium text_color_inactive ${styles.caption} ${styles.logout}`} onClick={() => logout()}>\r\n                Выход\r\n            </div>\r\n\r\n            <div className={`text text_type_main-default text_color_inactive mt-20`}>В этом разделе вы можете изменить свои персональные данные</div>\r\n        </div>\r\n    )\r\n}","import { getCookie } from \"../../utils/cookie\";\r\nimport { fetchWithRefresh } from \"../../services/fetchWithRefresh\";\r\nimport { IUser } from \"../../types/IUser\";\r\nimport { AppDispatch, AppThunk } from \"../reducers\";\r\n\r\nexport const GET_USER_REQUEST = 'GET_USER_REQUEST';\r\nexport const GET_USER_SUCCESS = 'GET_USER_SUCCESS';\r\nexport const GET_USER_ERROR = 'GET_USER_ERROR';\r\n\r\nexport const PATCH_USER_REQUEST = 'PATCH_USER_REQUEST';\r\nexport const PATCH_USER_SUCCESS = 'PATCH_USER_SUCCESS';\r\nexport const PATCH_USER_ERROR = 'PATCH_USER_ERROR';\r\n\r\nexport interface IGetUserRequestAction {\r\n    readonly type: typeof GET_USER_REQUEST;\r\n}\r\n\r\nexport interface IGetUserSuccessAction {\r\n    readonly type: typeof GET_USER_SUCCESS;\r\n    user: IUser;\r\n}\r\n\r\nexport interface IGetUserErrorAction {\r\n    readonly type: typeof GET_USER_ERROR;\r\n}\r\n\r\nexport interface IPatchUserRequestAction {\r\n    readonly type: typeof PATCH_USER_REQUEST;\r\n}\r\n\r\nexport interface IPatchUserSuccessAction {\r\n    readonly type: typeof PATCH_USER_SUCCESS;\r\n    user: IUser;\r\n}\r\n\r\nexport interface IPatchUserErrorAction {\r\n    readonly type: typeof PATCH_USER_ERROR;\r\n}\r\n\r\nexport type TProfileActions = \r\n    | IGetUserRequestAction\r\n    | IGetUserSuccessAction\r\n    | IGetUserErrorAction\r\n    | IPatchUserRequestAction\r\n    | IPatchUserSuccessAction\r\n    | IPatchUserErrorAction;\r\n\r\nexport const getUserRequest = (): IGetUserRequestAction => ({ type: GET_USER_REQUEST });\r\n\r\nexport const getUserSuccess = (user: IUser): IGetUserSuccessAction => ({ type: GET_USER_SUCCESS, user: user });\r\n\r\nexport const getUserError = (): IGetUserErrorAction => ({ type: GET_USER_ERROR });\r\n\r\nexport const patchUserRequest = (): IPatchUserRequestAction => ({ type: PATCH_USER_REQUEST });\r\n\r\nexport const patchUserSuccess = (user: IUser): IPatchUserSuccessAction => ({ type: PATCH_USER_SUCCESS, user: user });\r\n\r\nexport const patchUserError = (): IPatchUserErrorAction => ({ type: PATCH_USER_ERROR });\r\n\r\nconst USER_END_POINT = 'https://norma.nomoreparties.space/api/auth/user';\r\n\r\nexport const updateUserInfo: AppThunk = (email: string, name: string, password: string, onPatchSuccess: () => void) => (dispatch: AppDispatch) =>\r\n{\r\n    dispatch(patchUserRequest());\r\n\r\n    const accessToken = getCookie('accessToken');\r\n    const info = {\r\n        method: 'PATCH',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': accessToken ? accessToken : ''\r\n        },\r\n        body: JSON.stringify({ email: email, name: name, password: password })};\r\n\r\n    fetchWithRefresh(USER_END_POINT, info)\r\n    .then(response => {\r\n        if (response.success) {\r\n            return response;\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(patchUserSuccess(responseObj.user));\r\n        onPatchSuccess();\r\n    })\r\n    .catch(error => {\r\n        dispatch(patchUserError());\r\n        console.error(`Update user info error: ${error}`)\r\n    });\r\n}\r\n\r\nconst fetchGetUser = async () =>\r\n{\r\n    let accessToken = getCookie('accessToken');\r\n    if (!accessToken)\r\n        accessToken = '';\r\n\r\n    return await fetchWithRefresh(USER_END_POINT,\r\n    {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        cache: 'no-cache',\r\n        credentials: 'same-origin',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': accessToken\r\n        },\r\n        redirect: 'follow',\r\n        referrerPolicy: 'no-referrer',\r\n    })\r\n}\r\n\r\nexport const getUser: AppThunk = () => (dispatch: AppDispatch) =>\r\n{\r\n    dispatch(getUserRequest());\r\n\r\n    fetchGetUser()\r\n    .then(response => {\r\n        if (response.success) {\r\n            return response;\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(getUserSuccess(responseObj.user));\r\n    })\r\n    .catch(error => {\r\n        dispatch(getUserError());\r\n        console.error('Get user info error:', error)\r\n    });\r\n}","import { PasswordInput, Input, Button } from '@ya.praktikum/react-developer-burger-ui-components'\r\nimport styles from './Profile.module.css';\r\nimport './Profile.css';\r\nimport { FormEvent, FC, useEffect, useState } from 'react';\r\nimport { ProfileMenu } from '../../components/ProfileMenu/ProfileMenu';\r\nimport { getUser, updateUserInfo } from '../../redux/actions/profile';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\n\r\nexport const ProfilePage: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n    const [isModified, setIsModified] = useState(false);\r\n\r\n    const access = useSelector(store => store.access);\r\n    let initUser = access.user;\r\n\r\n    const [name, setName] = useState(initUser ? initUser.name : '');\r\n    const [email, setEmail] = useState(initUser ? initUser.email : '');\r\n    const [password, setPassword] = useState('');\r\n\r\n    const reset = () =>\r\n    {\r\n        if (!initUser || !isModified)\r\n            return;\r\n        \r\n        setName(initUser.name);\r\n        setEmail(initUser.email);\r\n        setPassword('');\r\n        setIsModified(false);\r\n    }\r\n\r\n    const updateUserInfoHandler = () => dispatch(updateUserInfo(email, name, password, onPathSuccess));\r\n\r\n    const onPathSuccess = () => {\r\n        setPassword('');\r\n        setIsModified(false);\r\n    }\r\n\r\n    // изменение полей\r\n    useEffect(() =>\r\n    {\r\n        if (initUser && (initUser.name !== name || initUser.email !== email || password !== ''))\r\n        {\r\n            setIsModified(true);\r\n            return;\r\n        }\r\n\r\n        setIsModified(false);\r\n    }, [initUser, name, email, password, setIsModified]);\r\n\r\n    // запрос данных на сервер\r\n    useEffect(() =>\r\n    {\r\n        if (initUser === null || initUser === undefined)\r\n            dispatch(getUser());\r\n    }, [initUser, dispatch]);\r\n\r\n    // заполнение полей\r\n    useEffect(() =>\r\n    {\r\n        if (!initUser)\r\n            return;\r\n            \r\n        setName(initUser.name);\r\n        setEmail(initUser.email);\r\n    }, [initUser])\r\n\r\n    const onSubmitHandler = (event: FormEvent) =>\r\n    {\r\n        event.preventDefault();\r\n        updateUserInfoHandler();\r\n    }\r\n\r\n    return (\r\n        <div className='page-cont'>\r\n            <ProfileMenu />\r\n            <form className='column' onSubmit={(event: FormEvent) => onSubmitHandler(event)}>\r\n                <div className={styles.field}>\r\n                    <Input onChange={(event) => setName(event.target.value)} value={name} name={'name'} size={'default'} placeholder={'Имя'} />\r\n                </div>\r\n                <div className={styles.field}>\r\n                    <Input onChange={(event) => setEmail(event.target.value)} value={email} name={'login'} size={'default'} placeholder={'Логин'} />\r\n                </div>\r\n                <div className={styles.field}>\r\n                    <PasswordInput onChange={(event) => setPassword(event.target.value)} value={password} name={'password'} />\r\n                </div>\r\n                { isModified && <div className={`${styles.field} ${styles.right}`}>\r\n                    <span className={`text text_type_main-default text_color_inactive ${styles.cancel}`} onClick={() => reset()} >\r\n                        Отмена\r\n                    </span>\r\n                    <Button type=\"primary\" size=\"medium\">\r\n                        Сохранить\r\n                    </Button>\r\n                </div>}\r\n            </form>\r\n        </div>\r\n    )\r\n}","import { FC } from 'react';\r\nimport { Redirect, Route } from 'react-router-dom';\r\nimport { useSelector } from '../../hooks';\r\n\r\ninterface IProtectedRouteProps {\r\n    path: string;\r\n    exact?: boolean;\r\n    children: React.ReactNode;\r\n}\r\n\r\nexport const ProtectedRoute:FC<IProtectedRouteProps> = ({ exact, children }) =>\r\n{\r\n    const isAuth = useSelector(store => store.access.isAuth);\r\n\r\n    return (\r\n        <Route\r\n            exact={exact === true}\r\n            render={({ location }) =>\r\n                isAuth ? (\r\n                    children\r\n                ) : (\r\n                <Redirect\r\n                    to={{\r\n                        pathname: '/login',\r\n                        state: { from: location }\r\n                    }}\r\n                />\r\n            )}\r\n        />\r\n    );\r\n}","import { FC } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { IngredientDetails } from \"../../components/IngredientDetails/IngredientDetails\";\r\nimport { useDispatch, useSelector } from \"../../hooks\";\r\nimport { setIngredient } from \"../../redux/actions/ingredient\";\r\nimport { IngredientData } from \"../../types/IIngredientData\";\r\n\r\ninterface IngredientId {\r\n    id: string\r\n}\r\n\r\nexport const IngredientPage: FC = () =>\r\n{\r\n    const { id } = useParams<IngredientId>();\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const ingredientsLib = useSelector(store => store.ingredientsLib.items);\r\n\r\n    const ingredient: IngredientData | undefined = ingredientsLib.find((item: IngredientData) => item._id === id);\r\n\r\n    if (!ingredient)\r\n        return null;\r\n\r\n    dispatch(setIngredient(ingredient));\r\n\r\n    return (\r\n        <div>\r\n            {ingredient && <IngredientDetails />}\r\n        </div>\r\n    )\r\n}","import { FC } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport styles from './NotFound404.module.css';\r\n\r\nexport const NotFound404Page: FC = () =>\r\n{\r\n    return (\r\n        <div className={styles.page}>\r\n            <div className='text_type_main-large'>\r\n                404 - Страница не найдена\r\n            </div>\r\n            <div className={styles.linkCont}>\r\n                <Link className={styles.blueLink} to='/'>\r\n                    Нажмите для перехода на главную страницу\r\n                </Link>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import styles from './OrderInfoDetails.module.css';\r\nimport { IOrderDetailsData } from '../../redux/reducers/orderDetails';\r\nimport { formatOrderDate } from '../../redux/reducers/utils';\r\nimport { CurrencyIcon } from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport { orderCostReducer } from '../../redux/reducers/constructor';\r\nimport { IngredientData } from '../../types/IIngredientData';\r\nimport { useSelector } from '../../hooks';\r\nimport { FC } from 'react';\r\n\r\nexport const OrderInfoDetails: FC = () =>\r\n{\r\n    const orderState = useSelector(store => store.orderDetails);\r\n\r\n    const orderData: IOrderDetailsData | null = orderState.orderData;\r\n\r\n    let cost;\r\n    let inProgressStatus;\r\n    let statusClassName;\r\n\r\n    if (orderData)\r\n    {\r\n        cost = orderCostReducer(orderData.ingredients.slice(1, orderData.ingredients.length), orderData.ingredients[0]);\r\n        inProgressStatus = orderData.status === 'pending';\r\n        statusClassName = !inProgressStatus ? styles.completed : '';\r\n    }\r\n\r\n    const getItemCont = (item: IngredientData, index: number) => {\r\n        \r\n        const style = {\r\n            backgroundImage: `url(${item.image_mobile})`\r\n        };\r\n        \r\n        return (\r\n            <div key={index} className={styles.itemCont}>\r\n                <div className={styles.leftItemCont}>\r\n                    <div style={style} className={styles.ingredientImage}>\r\n                    </div>\r\n                    <div className={`text text_type_main-default ml-4 pt-8 ${styles.nameCont}`}>\r\n                        <span className={styles.name}>{item.name}</span>\r\n                    </div>\r\n                </div>\r\n                <div className={styles.rightItemCont}>\r\n                    <div className={styles.itemPrice}>{item.price}</div>\r\n                    <div ><CurrencyIcon type='primary' /></div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={`${styles.page} modal-сontent`}>\r\n            <div className={`text text_type_digits-default mb-5 ${styles.center}`}>\r\n                #{orderData?.number}\r\n            </div>\r\n            <div className={`text text_type_main-medium mb-2`}>\r\n                {orderData?.name}\r\n            </div>\r\n            <div className={`text text_type_main-default mb-6 ${statusClassName}`}>\r\n                {inProgressStatus ? 'В работе' : 'Выполнен'}\r\n            </div>\r\n            <div className={`text text_type_main-medium mt-6`}>\r\n                Состав:\r\n            </div>\r\n            <div className={`mt-5 mb-3 ${styles.list}`}>\r\n                {orderData?.ingredients.map((item, index) => getItemCont(item, index))}\r\n            </div>\r\n            <div className={`mt-10 ${styles.bottom}`}>\r\n                <div className={`text text_type_main-default text_color_inactive`}>\r\n                    {formatOrderDate(orderData?.date ? orderData.date : null)}\r\n                </div>\r\n                <div className={styles.priceCont}>\r\n                    <span className={`${styles.cost} text text_type_digits-default`}>{cost}</span>\r\n                    <CurrencyIcon type=\"primary\" />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}","import { IngredientData } from \"../../types/IIngredientData\";\r\nimport { AppDispatch, AppThunk } from \"../reducers\";\r\n\r\nexport const GET_INGREDIENTS_LIB_REQUEST = 'GET_INGREDIENTS_LIB_REQUEST';\r\nexport const GET_INGREDIENTS_LIB_SUCCESS = 'GET_INGREDIENTS_LIB_SUCCESS';\r\nexport const GET_INGREDIENTS_LIB_ERROR = 'GET_INGREDIENTS_LIB_ERROR';\r\n\r\nexport interface IGetIngredientsLibRequestAction {\r\n    readonly type: typeof GET_INGREDIENTS_LIB_REQUEST;\r\n}\r\n\r\nexport interface IGetIngredientsLibSuccessAction {\r\n    readonly type: typeof GET_INGREDIENTS_LIB_SUCCESS;\r\n    readonly data: IngredientData[];\r\n}\r\n\r\nexport interface IGetIngredientsLibErrorAction {\r\n    readonly type: typeof GET_INGREDIENTS_LIB_ERROR;\r\n}\r\n\r\nexport type TGetIngredientsLibActions =\r\n    IGetIngredientsLibRequestAction |\r\n    IGetIngredientsLibSuccessAction |\r\n    IGetIngredientsLibErrorAction;\r\n\r\nexport const getIngredientsLibRequest = (): IGetIngredientsLibRequestAction => ({ type: GET_INGREDIENTS_LIB_REQUEST });\r\n\r\nexport const getIngredientsLibSuccess = (data: IngredientData[]): IGetIngredientsLibSuccessAction => ({ type: GET_INGREDIENTS_LIB_SUCCESS, data: data });\r\n\r\nexport const getIngredientsLibError = (): IGetIngredientsLibErrorAction => ({ type: GET_INGREDIENTS_LIB_ERROR });\r\n\r\nexport const getIngredientsLib: AppThunk = () => (dispatch: AppDispatch) =>\r\n{\r\n    const INGREDIENTS_ENDPOINT = 'https://norma.nomoreparties.space/api/ingredients';\r\n\r\n    dispatch(getIngredientsLibRequest());\r\n\r\n    fetch(INGREDIENTS_ENDPOINT)\r\n    .then(response => {\r\n        if (response.ok) {\r\n            return response.json();\r\n        }\r\n        return Promise.reject(`Status ${response.status}`);\r\n    })\r\n    .then(responseObj => {\r\n        dispatch(getIngredientsLibSuccess(responseObj.data));\r\n    })\r\n    .catch(error => \r\n    {\r\n        console.error(`Ingredients data receiving error: ${error}`);\r\n        dispatch(getIngredientsLibError());\r\n    });\r\n}","import { FC, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { OrderInfoDetails } from '../../components/OrderInfoDetails/OrderInfoDetails';\r\nimport { getOrderById } from '../../redux/actions/orderDetails';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\n\r\ninterface OrderId {\r\n    id: string;\r\n}\r\n\r\nexport const OrderDetailPage: FC = () =>\r\n{\r\n    const lib = useSelector(store => store.ingredientsLib);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const { id } = useParams<OrderId>();\r\n\r\n    useEffect(() => {\r\n        lib && lib.items.length && dispatch(getOrderById(id, lib));\r\n    }, [dispatch, id, lib]);\r\n\r\n    return (\r\n        <div>\r\n            {<OrderInfoDetails />}\r\n        </div>     \r\n    )\r\n}","import { WebSocketAction } from \"../middlewares/wsMiddleware\";\r\n\r\nexport const USER_WS_CONNECTION_START = 'USER_WS_CONNECTION_START';\r\nexport const USER_WS_CONNECTION_SUCCESS = 'USER_WS_CONNECTION_SUCCESS';\r\nexport const USER_WS_CONNECTION_ERROR = 'USER_WS_CONNECTION_ERROR';\r\nexport const USER_WS_CONNECTION_CLOSED = 'USER_WS_CONNECTION_CLOSED';\r\nexport const USER_WS_GET_MESSAGE = 'USER_WS_GET_MESSAGE';\r\n\r\nexport interface IUserWsConnectionStartAction extends WebSocketAction {\r\n    readonly type: typeof USER_WS_CONNECTION_START;\r\n    readonly payload: string;\r\n}\r\n\r\nexport interface IUserWsConnectionSuccessAction extends WebSocketAction {\r\n    readonly type: typeof USER_WS_CONNECTION_SUCCESS;\r\n}\r\n\r\nexport interface IUserWsConnectionErrorAction extends WebSocketAction {\r\n    readonly type: typeof USER_WS_CONNECTION_ERROR;\r\n}\r\n\r\nexport interface IUserWsConnectionClosedAction extends WebSocketAction {\r\n    readonly type: typeof USER_WS_CONNECTION_CLOSED;\r\n    readonly payload: string;\r\n}\r\n\r\nexport interface IUserWsGetMessageAction extends WebSocketAction {\r\n    readonly type: typeof USER_WS_GET_MESSAGE;\r\n    readonly payload: string;\r\n    readonly dispatch: Function;\r\n}\r\n\r\nexport type TUserWsActions =\r\n    IUserWsConnectionStartAction |\r\n    IUserWsConnectionSuccessAction |\r\n    IUserWsConnectionErrorAction |\r\n    IUserWsConnectionClosedAction |\r\n    IUserWsGetMessageAction;\r\n\r\nexport const userWsConnectionStart = (token: string): IUserWsConnectionStartAction => ({ type: USER_WS_CONNECTION_START, payload: token });\r\n\r\nexport const userWsConnectionSuccess = (): IUserWsConnectionSuccessAction => ({ type: USER_WS_CONNECTION_SUCCESS });\r\n\r\nexport const userWsConnectionError = (payload: string): IUserWsConnectionErrorAction => ({ type: USER_WS_CONNECTION_ERROR, payload: payload });\r\n\r\nexport const userWsConnectionClosed = (payload: string): IUserWsConnectionClosedAction => ({ type: USER_WS_CONNECTION_CLOSED, payload: payload });\r\n\r\nexport const userWsGetMessage = (message: string, dispatch: Function): IUserWsGetMessageAction => ({ type: USER_WS_GET_MESSAGE, payload: message, dispatch: dispatch });","import '@ya.praktikum/react-developer-burger-ui-components'\r\nimport { FC, useEffect } from 'react';\r\nimport { OrdersList } from '../../components/OrdersList/OrdersList';\r\nimport { ProfileMenu } from '../../components/ProfileMenu/ProfileMenu';\r\nimport { userWsConnectionStart } from '../../redux/actions/userWsActions';\r\nimport { useDispatch, useSelector } from '../../hooks';\r\nimport { getCookie } from '../../utils/cookie';\r\nimport styles from './ProfileOrders.module.css';\r\n\r\nexport const ProfileOrdersPage: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    const feed = useSelector(store => store.userWs.feed);\r\n\r\n    useEffect(() =>\r\n    {\r\n        let accessToken: string | undefined = getCookie('accessToken')?.substr(7);\r\n        if (!accessToken)\r\n            accessToken = '';\r\n\r\n        dispatch(userWsConnectionStart(accessToken));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <div className='page-cont'>\r\n            <ProfileMenu />\r\n            <div className={styles.page}>\r\n                <OrdersList type='large' feed={feed} />\r\n            </div>\r\n        </div>\r\n    )\r\n}","import styles from './App.module.css';\r\nimport { BrowserRouter as Router, Route, Switch, useHistory, useLocation } from 'react-router-dom';\r\nimport AppHeader from '../AppHeader/AppHeader';\r\nimport { ConstructorPage } from '../../pages/Constructor/Constructor';\r\nimport { SignInPage } from '../../pages/SignIn/SignIn';\r\nimport { RegisterPage } from '../../pages/Register/Register';\r\nimport { ForgotPasswordPage } from '../../pages/ForgotPassword/ForgotPassword';\r\nimport { ResetPasswordPage } from '../../pages/ResetPassword/ResetPassword';\r\nimport { OrdersFeedPage } from '../../pages/OrdersFeed/OrdersFeed';\r\nimport { ProfilePage } from '../../pages/Profile/Profile';\r\nimport { ProtectedRoute } from '../ProtectedRoute/ProtectedRoute';\r\nimport { IngredientPage } from '../../pages/Ingredient/Ingredient';\r\nimport { NotFound404Page } from '../../pages/NotFound404/NotFound404';\r\nimport { Modal } from '../Modal/Modal';\r\nimport { IngredientDetails } from '../IngredientDetails/IngredientDetails';\r\nimport { OrderInfoDetails } from '../OrderInfoDetails/OrderInfoDetails';\r\nimport { getIngredientsLib } from '../../redux/actions/ingredientsLib';\r\nimport { FC, useEffect } from 'react';\r\nimport { OrderDetailPage } from '../../pages/OrderDetail/OrderDetail';\r\nimport { ProfileOrdersPage } from '../../pages/ProfileOrders/ProfileOrders';\r\nimport { useDispatch } from '../../hooks';\r\nimport { Location } from 'history';\r\n\r\ninterface ILocationState {\r\n    background?: Location;\r\n}\r\n\r\nconst ModalSwitch: FC = () =>\r\n{\r\n    const location = useLocation<ILocationState>();\r\n    const history = useHistory();\r\n\r\n    const background = history.action === \"PUSH\" && location.state && location.state.background;\r\n\r\n    return (\r\n        <>\r\n            <AppHeader />\r\n            <Switch location={background || location}>\r\n                <Route path=\"/\" exact={true}>\r\n                    <ConstructorPage />\r\n                </Route>\r\n                <Route path=\"/login\" exact={true}>\r\n                    <SignInPage />\r\n                </Route>\r\n                <Route path=\"/register\" exact={true}>\r\n                    <RegisterPage />\r\n                </Route>\r\n                <Route path=\"/forgot-password\" exact={true}>\r\n                    <ForgotPasswordPage />\r\n                </Route>\r\n                <Route path=\"/reset-password\" exact={true}>\r\n                    <ResetPasswordPage />\r\n                </Route>\r\n                <Route path=\"/feed\" exact={true}>\r\n                    <OrdersFeedPage />\r\n                </Route>\r\n                <Route path=\"/feed/:id\" exact={true}>\r\n                    <OrderDetailPage />\r\n                </Route>\r\n                <Route path='/ingredients/:id' exact={true}>\r\n                    <IngredientPage />\r\n                </Route>\r\n                <ProtectedRoute path='/profile' exact={true}>\r\n                    <ProfilePage />\r\n                </ProtectedRoute>\r\n                <ProtectedRoute path='/profile/orders' exact={true}>\r\n                    <ProfileOrdersPage />\r\n                </ProtectedRoute>\r\n                <ProtectedRoute path='/profile/orders/:id' exact={true}>\r\n                    <OrderDetailPage />\r\n                </ProtectedRoute>\r\n                <Route>\r\n                    <NotFound404Page />\r\n                </Route>\r\n            </Switch>\r\n            \r\n            { background &&\r\n            <>\r\n                <Switch>\r\n                    <Route path={'/ingredients/:id'}>\r\n                        <Modal closeHandle={() => {history.goBack();}}>\r\n                            <IngredientDetails />\r\n                        </Modal>\r\n                    </Route>\r\n                    <Route path={'/feed/:id'}>\r\n                        <Modal closeHandle={() => {history.goBack();}}>\r\n                            <OrderInfoDetails />\r\n                        </Modal>\r\n                    </Route>\r\n                    <ProtectedRoute path={'/profile/orders/:id'}>\r\n                        <Modal closeHandle={() => {history.goBack();}}>\r\n                            <OrderInfoDetails />\r\n                        </Modal>\r\n                    </ProtectedRoute>\r\n                </Switch>\r\n            </>\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\nconst App: FC = () =>\r\n{\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        dispatch(getIngredientsLib())\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <div className={styles.appCont}>\r\n            <Router\r\n                basename='react-burger'>\r\n                <ModalSwitch />\r\n            </Router>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { IngredientData } from '../../types/IIngredientData';\r\nimport { GET_INGREDIENTS_LIB_REQUEST, GET_INGREDIENTS_LIB_SUCCESS, GET_INGREDIENTS_LIB_ERROR, TGetIngredientsLibActions } from '../actions/ingredientsLib';\r\n\r\nexport interface IIngredientsLibState\r\n{\r\n    items: IngredientData[];\r\n    itemsById: Map<string, IngredientData> | null;\r\n\r\n    isError: boolean;\r\n    isRequest: Boolean;\r\n}\r\n\r\nconst initState: IIngredientsLibState =\r\n{\r\n    items: [],\r\n    itemsById: new Map(),\r\n\r\n    isError: false,\r\n    isRequest: false\r\n}\r\n\r\nexport const ingredientsLibReducer = (state: IIngredientsLibState = initState, action: TGetIngredientsLibActions): IIngredientsLibState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case GET_INGREDIENTS_LIB_REQUEST:\r\n            return { items: [], itemsById: null, isError: false, isRequest: true };\r\n\r\n        case GET_INGREDIENTS_LIB_ERROR:\r\n            return { items: [], itemsById: null, isError: true, isRequest: false };\r\n\r\n        case GET_INGREDIENTS_LIB_SUCCESS:\r\n\r\n            let itemsById = new Map();\r\n\r\n            action.data.forEach((element: IngredientData) => {\r\n                itemsById.set(element._id, element);\r\n            });\r\n\r\n            return { items: action.data, itemsById: itemsById, isError: false, isRequest: false };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import { PLACE_ORDER_REQUEST, PLACE_ORDER_ERROR, PLACE_ORDER_SUCCESS, TPlaceOrderActions } from '../actions/order';\r\n\r\nexport interface IOrderState\r\n{\r\n    orderId: number;\r\n\r\n    isError: boolean;\r\n    isRequest: boolean;\r\n}\r\n\r\nconst initState: IOrderState = {\r\n    orderId: 0,\r\n\r\n    isError: false,\r\n    isRequest: false\r\n}\r\n\r\nexport const orderReducer = (state = initState, action: TPlaceOrderActions) =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case PLACE_ORDER_REQUEST:\r\n            return { orderId: 0, isError: false, isRequest: true };\r\n\r\n        case PLACE_ORDER_SUCCESS:\r\n            return { orderId: action.orderId, isError: false, isRequest: false };\r\n\r\n        case PLACE_ORDER_ERROR:\r\n            return { orderId: 0, isError: true, isRequest: false };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import { INIT_RESET_PASSWORD_REQUEST, INIT_RESET_PASSWORD_ERROR, INIT_RESET_PASSWORD_SUCCESS, TInitResetPasswordActions } from '../actions/initResetPassword';\r\n\r\nexport interface IInitResetPasswordState\r\n{\r\n    success: boolean;\r\n    message: string;\r\n\r\n    isError: boolean;\r\n    isRequest: boolean;\r\n}\r\n\r\nexport const initState: IInitResetPasswordState =\r\n{\r\n    success: false,\r\n    message: '',\r\n\r\n    isError: false,\r\n    isRequest: false\r\n}\r\n\r\nexport const initResetPasswordReducer = (state = initState, action: TInitResetPasswordActions): IInitResetPasswordState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case INIT_RESET_PASSWORD_REQUEST:\r\n            return { ...state, isError: false, isRequest: true };\r\n\r\n        case INIT_RESET_PASSWORD_SUCCESS:\r\n            return { success: true, message: action.message, isError: false, isRequest: false };\r\n\r\n        case INIT_RESET_PASSWORD_ERROR:\r\n            return { success: false, message: '', isError: true, isRequest: false };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import { RESET_PASSWORD_REQUEST, RESET_PASSWORD_ERROR, RESET_PASSWORD_SUCCESS, TResetPasswordActions } from '../actions/resetPassword';\r\n\r\nexport interface IResetPasswordState\r\n{\r\n    success: boolean;\r\n    message: string;\r\n\r\n    isError: boolean;\r\n    isRequest: boolean;\r\n}\r\n\r\nexport const initState: IResetPasswordState =\r\n{\r\n    success: false,\r\n    message: '',\r\n\r\n    isError: false,\r\n    isRequest: false\r\n}\r\n\r\nexport const resetPasswordReducer = (state = initState, action: TResetPasswordActions): IResetPasswordState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case RESET_PASSWORD_REQUEST:\r\n            return { ...state, isError: false, isRequest: true };\r\n\r\n        case RESET_PASSWORD_SUCCESS:\r\n            return { success: true, message: action.message, isError: false, isRequest: false };\r\n\r\n        case RESET_PASSWORD_ERROR:\r\n            return { success: false, message: '', isError: true, isRequest: false };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import { SIGNIN_REQUEST, SIGNIN_ERROR, SIGNIN_SUCCESS, LOGOUT_SUCCESS, LOGOUT_REQUEST, LOGOUT_ERROR, TAuthActions } from '../actions/auth';\r\nimport { REGISTER_REQUEST, REGISTER_ERROR, REGISTER_SUCCESS, TRegisterActions } from '../actions/register';\r\nimport { GET_USER_ERROR, GET_USER_REQUEST, GET_USER_SUCCESS, PATCH_USER_ERROR, PATCH_USER_REQUEST, PATCH_USER_SUCCESS, TProfileActions } from '../actions/profile';\r\nimport { getCookie, setCookie } from '../../utils/cookie';\r\nimport { User } from '../../types/IUser';\r\n\r\nexport interface IAccessState\r\n{\r\n    success: boolean;\r\n    user: User;\r\n\r\n    isError: boolean;\r\n    isRequest: boolean;\r\n\r\n    isAuth: boolean;\r\n}\r\n\r\nconst initState: IAccessState =\r\n{\r\n    success: false,\r\n    user: undefined,\r\n\r\n    isError: false,\r\n    isRequest: false,\r\n\r\n    isAuth: getCookie('refreshToken') !== undefined && getCookie('refreshToken') !== \"\"\r\n}\r\n\r\nexport type TAccessActions =\r\n    TAuthActions |\r\n    TRegisterActions |\r\n    TProfileActions;\r\n\r\nexport const accessReducer = (state: IAccessState = initState, action: TAccessActions): IAccessState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case REGISTER_REQUEST:\r\n        case SIGNIN_REQUEST:\r\n            return { ...state, isError: false, isRequest: true, isAuth: false };\r\n\r\n        case LOGOUT_REQUEST:\r\n        case PATCH_USER_REQUEST:\r\n        case GET_USER_REQUEST:\r\n            return { ...state, isError: false, isRequest: true, isAuth: true };\r\n\r\n        case REGISTER_ERROR:\r\n        case SIGNIN_ERROR:\r\n            return { ...state, isError: true, isRequest: false, isAuth: false };\r\n\r\n        case LOGOUT_ERROR:\r\n        case PATCH_USER_ERROR:\r\n        case GET_USER_ERROR:\r\n            return { ...state, isError: true, isRequest: false, isAuth: true };\r\n\r\n        case REGISTER_SUCCESS:\r\n        case SIGNIN_SUCCESS:\r\n        {\r\n            setCookie('accessToken', action.accessToken);\r\n            setCookie('refreshToken', action.refreshToken);\r\n            return { success: true, user: action.user, isError: false, isRequest: false, isAuth: true };\r\n        }\r\n\r\n        case GET_USER_SUCCESS:\r\n        case PATCH_USER_SUCCESS:\r\n            return { ...state, success: true, user: action.user };\r\n\r\n        case LOGOUT_SUCCESS:\r\n        {\r\n            setCookie('accessToken', '');\r\n            setCookie('refreshToken', '');\r\n            return { ...state, success: true, isError: false, isRequest: false, user: null, isAuth: false };\r\n        }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import { IngredientData } from '../../types/IIngredientData';\r\nimport { OrderStatus } from '../../types/IOrderData';\r\nimport { GET_ORDER_BY_ID_ERROR, GET_ORDER_BY_ID_REQUEST, GET_ORDER_BY_ID_SUCCESS, SET_ORDER_DETAIL, TOrderDetailsActions } from '../actions/orderDetails';\r\n\r\nexport interface IOrderDetailsData {\r\n    number: number;\r\n    ingredients: IngredientData[];\r\n    name: string;\r\n    date: Date;\r\n    status: OrderStatus;\r\n}\r\n\r\nexport interface IOrderDetailsState\r\n{\r\n    success: boolean;\r\n    orderData: IOrderDetailsData | null;\r\n\r\n    isRequest: boolean;\r\n    isError: boolean;\r\n}\r\n\r\nconst initState: IOrderDetailsState =\r\n{\r\n    success: false,\r\n    orderData: null,\r\n    isRequest: false,\r\n    isError: false\r\n}\r\n\r\nexport const orderDetailsReducer = (state = initState, action: TOrderDetailsActions): IOrderDetailsState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case GET_ORDER_BY_ID_REQUEST:\r\n            return { ...initState, isRequest: true };\r\n\r\n        case GET_ORDER_BY_ID_SUCCESS:\r\n        case SET_ORDER_DETAIL:\r\n            return { ...initState, success: true, orderData: action.orderData };\r\n\r\n        case GET_ORDER_BY_ID_ERROR:\r\n            return { ...initState, isRequest: false, isError: true };\r\n            \r\n        default:\r\n            return state;\r\n    }\r\n}","import { IOrderFeedWebSocketState } from '../../types/IOrderData';\r\nimport {\r\n    FEED_WS_CONNECTION_START, FEED_WS_CONNECTION_CLOSED, FEED_WS_CONNECTION_ERROR, FEED_WS_CONNECTION_SUCCESS, FEED_WS_GET_MESSAGE,\r\n    TFeedWsActions, feedWsConnectionSuccess, feedWsConnectionError, feedWsConnectionClosed, feedWsGetMessage } from '../actions/feedWsActions';\r\nimport { IWsActions } from '../middlewares/wsMiddleware';\r\n\r\nexport const wsActionsFeed: IWsActions =\r\n{\r\n    wsInit: FEED_WS_CONNECTION_START,\r\n    onOpen: () => feedWsConnectionSuccess(),\r\n    onClose: (payload: string) => feedWsConnectionClosed(payload),\r\n    onError: (payload: string) => feedWsConnectionError(payload),\r\n    onMessage: (payload: string, dispatch?: Function) => feedWsGetMessage(payload)\r\n};\r\n\r\nexport const initialState: IOrderFeedWebSocketState =\r\n{\r\n    wsConnected: false,\r\n    error: null,\r\n    feed: null\r\n};\r\n\r\nexport const ORDERS_FEED_ENDPOINT: string = 'wss://norma.nomoreparties.space/orders/all';\r\n\r\nexport const feedWsReducer = (state: IOrderFeedWebSocketState = initialState, action: TFeedWsActions): IOrderFeedWebSocketState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case FEED_WS_CONNECTION_SUCCESS:\r\n            return { ...state, error: null, wsConnected: true };\r\n\r\n        case FEED_WS_CONNECTION_ERROR:\r\n            return { ...state, error: action.payload, wsConnected: false };\r\n\r\n        case FEED_WS_CONNECTION_CLOSED:\r\n            return { ...state, error: null, wsConnected: false };\r\n\r\n        case FEED_WS_GET_MESSAGE:\r\n            return { ...state, error: null, feed: JSON.parse(action.payload) };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}; ","import { MiddlewareAPI } from \"redux\";\r\n\r\nexport interface WebSocketAction {\r\n    readonly type: string;\r\n    readonly payload?: string;\r\n};\r\n\r\nexport interface IWsActions\r\n{\r\n    wsInit: string;\r\n    onOpen: () => WebSocketAction,\r\n    onClose: (payload: string) => WebSocketAction,\r\n    onError: (payload: string) => WebSocketAction,\r\n    onMessage: (payload: string, dispatch: Function) => WebSocketAction\r\n}\r\n\r\ninterface ErrorEvent extends Event {\r\n    message?: string;\r\n}\r\n\r\nexport const socketMiddleware = (wsUrl: string, wsActions: IWsActions) =>\r\n{\r\n    return (store: MiddlewareAPI) =>\r\n    {\r\n        let socket: WebSocket | null = null;\r\n\r\n        return (next: Function) => (action: WebSocketAction) =>\r\n        {\r\n            const { dispatch } = store;\r\n            const { type, payload } = action;\r\n\r\n            if (type === wsActions.wsInit) {\r\n                let url = wsUrl;\r\n                if (payload)\r\n                    url += '?token=' + payload;\r\n\r\n                socket = new WebSocket(url);\r\n            }\r\n\r\n            if (socket)\r\n            {\r\n                socket.onopen = () => {\r\n                    dispatch(wsActions.onOpen());\r\n                };\r\n\r\n                socket.onerror = (event: ErrorEvent) => {\r\n                    dispatch(wsActions.onError(event.message ? event.message : 'unknown error'));\r\n                };\r\n\r\n                socket.onmessage = (event: MessageEvent) =>\r\n                {\r\n                    const { data } = event;\r\n                    dispatch(wsActions.onMessage(data, dispatch));\r\n                };\r\n\r\n                socket.onclose = (event: CloseEvent) => {\r\n                    dispatch(wsActions.onClose(event.reason));\r\n                };\r\n            }\r\n\r\n            next(action);\r\n        };\r\n    };\r\n}; ","import { refreshToken } from '../../services/fetchWithRefresh';\r\nimport { IOrderFeedWebSocketState } from '../../types/IOrderData';\r\nimport { setCookie } from '../../utils/cookie';\r\nimport {\r\n    USER_WS_CONNECTION_START, USER_WS_CONNECTION_CLOSED, USER_WS_CONNECTION_ERROR, USER_WS_CONNECTION_SUCCESS, USER_WS_GET_MESSAGE,\r\n    TUserWsActions, userWsConnectionSuccess, userWsConnectionError, userWsConnectionClosed, userWsGetMessage, userWsConnectionStart } from '../actions/userWsActions';\r\nimport { IWsActions } from '../middlewares/wsMiddleware';\r\n\r\nexport const wsActionsUser: IWsActions =\r\n{\r\n    wsInit: USER_WS_CONNECTION_START,\r\n    onOpen: () => userWsConnectionSuccess(),\r\n    onClose: (payload: string) => userWsConnectionClosed(payload),\r\n    onError: (payload: string) => userWsConnectionError(payload),\r\n    onMessage: (payload: string, dispatch: Function) => userWsGetMessage(payload, dispatch)\r\n};\r\n\r\nexport const initialState: IOrderFeedWebSocketState =\r\n{\r\n    wsConnected: false,\r\n    error: null,\r\n    feed: null\r\n};\r\n\r\nexport const ORDERS_USER_ENDPOINT: string = 'wss://norma.nomoreparties.space/orders';\r\n\r\nexport const userWsReducer = (state: IOrderFeedWebSocketState = initialState, action: TUserWsActions): IOrderFeedWebSocketState =>\r\n{\r\n   switch (action.type)\r\n    {\r\n        case USER_WS_CONNECTION_SUCCESS:\r\n            return { ...state, error: null, wsConnected: true };\r\n\r\n        case USER_WS_CONNECTION_ERROR:\r\n            return { ...state, error: action.payload ? action.payload : '', wsConnected: false };\r\n\r\n        case USER_WS_CONNECTION_CLOSED:\r\n            return { ...state, error: null, wsConnected: false };\r\n\r\n        case USER_WS_GET_MESSAGE:\r\n        {\r\n            const response = JSON.parse(action.payload);\r\n\r\n            if (response.message === \"Invalid or missing token\")\r\n            {\r\n                refreshToken()\r\n                .then(res =>\r\n                {\r\n                    setCookie('accessToken', res.accessToken);\r\n                    action.dispatch(userWsConnectionStart(res.accessToken.substr(7)));\r\n                })\r\n                .catch(err => console.error('WS: Refresh token error: ', err));\r\n\r\n                return { ...state, error: 'Invalid or missing token', feed: null };\r\n            }\r\n            \r\n            return { ...state, error: null, feed: JSON.parse(action.payload) };\r\n        }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}; ","import { ActionCreator, applyMiddleware, combineReducers, compose, createStore } from 'redux';\r\nimport { ingredientsLibReducer } from './ingredientsLib';\r\nimport { constructorReducer } from './constructor';\r\nimport { orderReducer } from './order';\r\nimport { ingredientReducer } from './ingredient';\r\nimport { initResetPasswordReducer } from './initResetPassword';\r\nimport { resetPasswordReducer } from './resetPassword';\r\nimport { accessReducer } from './access';\r\nimport { orderDetailsReducer } from './orderDetails';\r\nimport { feedWsReducer, ORDERS_FEED_ENDPOINT, wsActionsFeed } from './feedWsReducer';\r\nimport thunk, { ThunkAction } from 'redux-thunk';\r\nimport { socketMiddleware } from '../middlewares/wsMiddleware';\r\nimport { ORDERS_USER_ENDPOINT, userWsReducer, wsActionsUser } from './userWsReducer';\r\nimport { TAuthActions } from '../actions/auth';\r\nimport { TConstructorActions } from '../actions/constructor';\r\nimport { ISetIngredientAction } from '../actions/ingredient';\r\nimport { TGetIngredientsLibActions } from '../actions/ingredientsLib';\r\nimport { TInitResetPasswordActions } from '../actions/initResetPassword';\r\nimport { TPlaceOrderActions } from '../actions/order';\r\nimport { TOrderDetailsActions } from '../actions/orderDetails';\r\nimport { TProfileActions } from '../actions/profile';\r\nimport { TRegisterActions } from '../actions/register';\r\nimport { TResetPasswordActions } from '../actions/resetPassword';\r\nimport { TFeedWsActions } from '../actions/feedWsActions';\r\nimport { TUserWsActions } from '../actions/userWsActions';\r\n\r\nexport const rootReducer = combineReducers({\r\n    ingredientsLib: ingredientsLibReducer,\r\n    constructor: constructorReducer,\r\n    ingredient: ingredientReducer,\r\n    order: orderReducer,\r\n    initResetPassword: initResetPasswordReducer,\r\n    resetPassword: resetPasswordReducer,\r\n    access: accessReducer,\r\n    orderDetails: orderDetailsReducer,\r\n    feedWs: feedWsReducer,\r\n    userWs: userWsReducer,\r\n});\r\n\r\ndeclare global {\r\n    interface Window {\r\n      __REDUX_DEVTOOLS_EXTENSION_COMPOSE__?: typeof compose;\r\n    }\r\n}\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst wsFeed = socketMiddleware(ORDERS_FEED_ENDPOINT, wsActionsFeed);\r\nconst wsUser = socketMiddleware(ORDERS_USER_ENDPOINT, wsActionsUser);\r\n\r\nconst middleWares = applyMiddleware(thunk, wsFeed, wsUser);\r\nconst enhancer = composeEnhancers(middleWares);\r\n\r\nexport const store = createStore(rootReducer, enhancer);\r\n\r\nexport type TStore = ReturnType<typeof rootReducer>;\r\n\r\ntype TApplicationActions = \r\n    TAuthActions |\r\n    TConstructorActions |\r\n    ISetIngredientAction |\r\n    TGetIngredientsLibActions |\r\n    TInitResetPasswordActions |\r\n    TPlaceOrderActions |\r\n    TOrderDetailsActions |\r\n    TProfileActions |\r\n    TRegisterActions |\r\n    TResetPasswordActions |\r\n    TFeedWsActions |\r\n    TUserWsActions;\r\n\r\nexport type AppThunk<TReturn = void> = ActionCreator<ThunkAction<TReturn, TStore, unknown, TApplicationActions> >;\r\n\r\nexport type AppDispatch = typeof store.dispatch;","import { IngredientData } from '../../types/IIngredientData';\r\nimport { ISetIngredientAction, SET_INGREDIENT } from '../actions/ingredient';\r\n\r\ntype IngredientDataState = IngredientData | null;\r\n\r\nexport const ingredientReducer = (state: IngredientDataState = null, action: ISetIngredientAction): IngredientDataState =>\r\n{\r\n    switch (action.type)\r\n    {\r\n        case SET_INGREDIENT:\r\n            return action.ingredientData;\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './components/App/App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { Provider } from 'react-redux';\r\nimport { store } from './redux/reducers/index';\r\n\r\nReactDOM.render( \r\n    <React.StrictMode>\r\n        <Provider store={store}>\r\n            <App />\r\n        </Provider>\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);\r\n\r\nreportWebVitals();","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"OrdersStat_section__24Kc0\",\"statOper\":\"OrdersStat_statOper__1I7d_\",\"statOperCol\":\"OrdersStat_statOperCol__1T1a-\",\"statOrderList\":\"OrdersStat_statOrderList__3TLMD\",\"statCont\":\"OrdersStat_statCont__2bVub\",\"digitsLarge\":\"OrdersStat_digitsLarge__4GU84\",\"completedOrder\":\"OrdersStat_completedOrder__3VtpP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"RegisterForm_title__2GI2t\",\"formRow\":\"RegisterForm_formRow__2OiS2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"column\":\"Profile_column__2IKR6\",\"field\":\"Profile_field__1VYuj\",\"right\":\"Profile_right__h7Dx3\",\"cancel\":\"Profile_cancel__2jJ_o\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"AppHeader_row__IKbVN\",\"sideRow\":\"AppHeader_sideRow__3x-Os\",\"left\":\"AppHeader_left__DRFC5\",\"right\":\"AppHeader_right__1dCL4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuItem\":\"IngredientMenuItem_menuItem__tgV2L\",\"isDrag\":\"IngredientMenuItem_isDrag__2ysxm\",\"priceBlock\":\"IngredientMenuItem_priceBlock__prwGz\",\"price\":\"IngredientMenuItem_price__1iYDU\",\"name\":\"IngredientMenuItem_name__1IVcE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"links\":\"SignIn_links__3xnxK\",\"blueLink\":\"SignIn_blueLink__1Mqna\",\"linksRow\":\"SignIn_linksRow__3mPjb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"SignInForm_title__JoCwh\",\"formRow\":\"SignInForm_formRow__27-u4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"ResetPasswordForm_title__SAF8y\",\"formRow\":\"ResetPasswordForm_formRow__1EkwP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"column\":\"ProfileMenu_column__1kzTW\",\"caption\":\"ProfileMenu_caption__3Ni3e\",\"logout\":\"ProfileMenu_logout__a4Eyk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"BurgerConstructor_section__2_q20\",\"scrollableList\":\"BurgerConstructor_scrollableList__1LKZb\",\"buttonWrapper\":\"BurgerConstructor_buttonWrapper__3JTKg\",\"commitOrderWrapper\":\"BurgerConstructor_commitOrderWrapper__GO1m9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"IngredientDetails_container__1ro-h\",\"pageContainer\":\"IngredientDetails_pageContainer__22NlN\",\"title\":\"IngredientDetails_title__2DlCc\",\"characteristics\":\"IngredientDetails_characteristics__2btLY\",\"charItem\":\"IngredientDetails_charItem__3X_8h\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"orderDetail\":\"OrderDetails_orderDetail__TjMmJ\",\"orderId\":\"OrderDetails_orderId__gMsp-\",\"forming\":\"OrderDetails_forming__36FRU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"center\":\"Register_center__r1BCa\",\"links\":\"Register_links__2T0xQ\",\"blueLink\":\"Register_blueLink__1po_m\",\"linksRow\":\"Register_linksRow__1Rm3U\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"links\":\"ForgotPassword_links__Ef8hv\",\"center\":\"ForgotPassword_center__BlhVu\",\"blueLink\":\"ForgotPassword_blueLink__3ZQVX\",\"linksRow\":\"ForgotPassword_linksRow__1yfW3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"ForgotPasswordForm_title__3SF4i\",\"formRow\":\"ForgotPasswordForm_formRow__2rwnZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"links\":\"ResetPassword_links__GUJy-\",\"center\":\"ResetPassword_center__12DBQ\",\"blueLink\":\"ResetPassword_blueLink__1rv1J\",\"linksRow\":\"ResetPassword_linksRow__1GMPi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"OrdersList_section__3hkZO\",\"smallSection\":\"OrdersList_smallSection__1p2_Y\",\"largeSection\":\"OrdersList_largeSection__1NjT4\",\"itemsCont\":\"OrdersList_itemsCont__GFMRq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"IngredientMenuList_list__1ZPnF\",\"listCategory\":\"IngredientMenuList_listCategory__1nksE\",\"categoryBlock\":\"IngredientMenuList_categoryBlock__3zQ42\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"IngredientsListItem_item__mKDEX\",\"isDrag\":\"IngredientsListItem_isDrag__V_xHi\",\"element\":\"IngredientsListItem_element__3EQDb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"NotFound404_page__txqQf\",\"linkCont\":\"NotFound404_linkCont__OZrMx\",\"blueLink\":\"NotFound404_blueLink__1jFtM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"HeaderItem_item__db9d2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"BurgerIngredients_section__ryXty\",\"menu\":\"BurgerIngredients_menu__1VAwD\"};"],"sourceRoot":""}